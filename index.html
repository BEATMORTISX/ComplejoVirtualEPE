<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complejo Virtual EPE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ===== VARIABLES Y RESET ===== */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --info-color: #2980b9;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --gray-color: #7f8c8d;
            --border-color: #bdc3c7;
            
            --gradient-primary: linear-gradient(135deg, #2c3e50, #34495e);
            --gradient-secondary: linear-gradient(135deg, #3498db, #2980b9);
            --gradient-success: linear-gradient(135deg, #27ae60, #2ecc71);
            --gradient-warning: linear-gradient(135deg, #f39c12, #f1c40f);
            --gradient-danger: linear-gradient(135deg, #e74c3c, #c0392b);
            
            --radius: 10px;
            --radius-lg: 15px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.15);
            
            --sidebar-width: 280px;
            --header-height: 80px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* ===== BOTONES ===== */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            background: var(--gradient-secondary);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-success {
            background: var(--gradient-success);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-warning {
            background: var(--gradient-warning);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-danger {
            background: var(--gradient-danger);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-info {
            background: linear-gradient(135deg, #2980b9, #3498db);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: 0.9rem;
        }
        
        /* ===== LAYOUT GENERAL ===== */
        .hidden {
            display: none !important;
        }
        
        /* ===== LOGIN SCREEN ===== */
        #login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #2c3e50 0%, #4a6491 100%);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .login-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 500px;
            overflow: hidden;
            animation: slideUp 0.6s ease-out;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .logo-section {
            background: var(--gradient-primary);
            color: white;
            padding: 2.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .logo-placeholder {
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 3rem;
            position: relative;
            z-index: 1;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }
        
        .institution-name {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .system-title {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 30px;
            display: inline-block;
            margin-bottom: 1rem;
            font-size: 1rem;
            position: relative;
            z-index: 1;
            backdrop-filter: blur(5px);
        }
        
        .connection-mode-selector {
            display: flex;
            gap: 10px;
            margin: 20px auto;
            max-width: 300px;
        }
        
        .connection-mode-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .connection-mode-btn.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        /* ===== FORMULARIOS ===== */
        #login-form {
            padding: 2.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 14px 16px 14px 45px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
            color: #333;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .input-icon {
            position: absolute;
            left: 16px;
            top: 42px;
            color: var(--gray-color);
            z-index: 1;
        }
        
        .password-toggle {
            position: absolute;
            right: 16px;
            top: 42px;
            background: none;
            border: none;
            color: var(--gray-color);
            cursor: pointer;
            z-index: 1;
        }
        
        /* ===== DASHBOARD LAYOUT ===== */
        .dashboard-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: #f5f7fa;
        }
        
        .dashboard-header {
            background: white;
            box-shadow: var(--shadow);
            padding: 0 2rem;
            height: var(--header-height);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid var(--secondary-color);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .logo-mini {
            font-size: 2rem;
            color: var(--secondary-color);
        }
        
        .header-title h1 {
            margin: 0;
            font-size: 1.8rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 8px 16px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: var(--radius);
            border-left: 4px solid var(--secondary-color);
        }
        
        .user-avatar {
            width: 50px;
            height: 50px;
            background: var(--gradient-primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3rem;
            box-shadow: var(--shadow);
        }
        
        .user-details h4 {
            margin: 0;
            font-size: 1.1rem;
        }
        
        .user-details small {
            color: var(--gray-color);
            font-size: 0.9rem;
        }
        
        /* ===== SIDEBAR ===== */
        .dashboard-content {
            display: flex;
            flex: 1;
        }
        
        .dashboard-nav {
            width: var(--sidebar-width);
            background: white;
            border-right: 1px solid var(--border-color);
            padding: 2rem 0;
            position: sticky;
            top: var(--header-height);
            height: calc(100vh - var(--header-height));
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
        }
        
        .nav-section {
            margin-bottom: 2.5rem;
            padding: 0 1.5rem;
        }
        
        .nav-title {
            font-size: 0.9rem;
            text-transform: uppercase;
            color: var(--gray-color);
            margin-bottom: 1rem;
            font-weight: 600;
            letter-spacing: 1px;
            padding-left: 10px;
            border-left: 3px solid var(--secondary-color);
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: var(--dark-color);
            text-decoration: none;
            border-radius: var(--radius);
            margin-bottom: 8px;
            transition: all 0.3s;
            cursor: pointer;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: linear-gradient(90deg, rgba(52, 152, 219, 0.1), transparent);
            border-left-color: var(--secondary-color);
            transform: translateX(5px);
        }
        
        .nav-item.active {
            background: linear-gradient(90deg, var(--secondary-color), transparent);
            color: white;
            border-left-color: var(--secondary-color);
        }
        
        .nav-item.active i {
            color: white;
        }
        
        .nav-item i {
            width: 20px;
            text-align: center;
            color: var(--secondary-color);
        }
        
        /* ===== CONTENIDO PRINCIPAL ===== */
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
        }
        
        .content-section {
            animation: fadeIn 0.5s ease-out;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* ===== TARJETAS ===== */
        .card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2rem;
            border-top: 5px solid var(--secondary-color);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light-color);
        }
        
        /* ===== TABLAS ===== */
        .table-responsive {
            overflow-x: auto;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background: var(--gradient-primary);
            color: white;
            padding: 15px 20px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        td {
            padding: 15px 20px;
            border-bottom: 1px solid var(--light-color);
            vertical-align: middle;
        }
        
        tr:hover {
            background: rgba(52, 152, 219, 0.05);
        }
        
        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge-success {
            background: linear-gradient(135deg, var(--success-color), #2ecc71);
            color: white;
        }
        
        .badge-warning {
            background: linear-gradient(135deg, var(--warning-color), #f1c40f);
            color: white;
        }
        
        .badge-danger {
            background: linear-gradient(135deg, var(--danger-color), #c0392b);
            color: white;
        }
        
        .badge-info {
            background: linear-gradient(135deg, var(--info-color), var(--secondary-color));
            color: white;
        }
        
        /* ===== ESTADÍSTICAS ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 1.5rem;
            transition: all 0.3s;
            border-top: 4px solid var(--secondary-color);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .stat-icon {
            width: 70px;
            height: 70px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            box-shadow: var(--shadow);
        }
        
        .stat-info h3 {
            margin: 0;
            font-size: 2.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-info p {
            margin: 0;
            color: var(--gray-color);
            font-size: 1.1rem;
        }
        
        /* ===== MODALES ===== */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: modalIn 0.4s ease-out;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .modal-header {
            padding: 1.5rem 2rem;
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        .modal-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }
        
        .close-modal {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        
        /* ===== ALERTAS ===== */
        #alert-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 3000;
            max-width: 400px;
        }
        
        .alert {
            background: white;
            border-radius: var(--radius);
            padding: 1.2rem 1.5rem;
            margin-bottom: 15px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideInRight 0.3s ease-out;
            border-left: 5px solid var(--primary-color);
            position: relative;
            overflow: hidden;
        }
        
        .alert-success {
            border-left-color: var(--success-color);
        }
        
        .alert-error {
            border-left-color: var(--danger-color);
        }
        
        .alert-warning {
            border-left-color: var(--warning-color);
        }
        
        .alert-info {
            border-left-color: var(--info-color);
        }
        
        .alert i {
            font-size: 1.5rem;
        }
        
        /* ===== CONEXIÓN STATUS ===== */
        .connection-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            padding: 12px 20px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            box-shadow: var(--shadow-lg);
            animation: fadeIn 0.4s;
            color: white;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .connection-online {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.9), rgba(46, 204, 113, 0.9));
        }
        
        .connection-offline {
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.9), rgba(192, 57, 43, 0.9));
        }
        
        /* ===== BOTÓN GITHUB ===== */
        .github-btn {
            background: linear-gradient(135deg, #333, #555);
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .github-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        /* ===== BOTÓN REPARACIÓN ===== */
        .repair-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            margin-left: 10px;
        }
        
        /* ===== ANIMACIONES ===== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes modalIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 1024px) {
            .dashboard-nav {
                width: 80px;
                padding: 1.5rem 0;
            }
            
            .nav-title,
            .nav-item span:last-child {
                display: none;
            }
            
            .nav-item {
                justify-content: center;
                padding: 15px;
            }
            
            .header-title h1 {
                font-size: 1.5rem;
            }
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .dashboard-header {
                padding: 0 1rem;
            }
            
            .content-area {
                padding: 1rem;
            }
            
            .card {
                padding: 1.5rem;
            }
        }
        
        /* ===== UTILIDADES ===== */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-left { text-align: left; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-1 { gap: 0.5rem; }
        .gap-2 { gap: 1rem; }
        .gap-3 { gap: 1.5rem; }
        .w-full { width: 100%; }
        .h-full { height: 100%; }
        
        /* ===== GRID FORMULARIOS ===== */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        /* ===== BOTÓN DE VOLVER ===== */
        .back-btn {
            background: var(--gradient-primary);
            color: white;
            margin-bottom: 2rem;
        }
        
        /* ===== LOADER ===== */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--secondary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- ===== CONEXIÓN STATUS ===== -->
    <div id="connection-status" class="connection-status connection-offline">
        <i class="fas fa-wifi-slash"></i>
        <span>Modo Offline</span>
    </div>
    
    <!-- ===== ALERTAS ===== -->
    <div id="alert-container"></div>

    <!-- ===== PANTALLA DE LOGIN ===== -->
    <div id="login-container">
        <div class="login-card">
            <div class="logo-section">
                <div class="logo-placeholder">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h1 class="institution-name">Complejo Virtual EPE</h1>
                <div class="system-title">
                    <i class="fas fa-cogs"></i> SISTEMA CRM EDUCATIVO
                </div>
                
                <div class="connection-mode-selector">
                    <div class="connection-mode-btn active" data-mode="online">
                        <i class="fas fa-wifi"></i> Online
                    </div>
                    <div class="connection-mode-btn" data-mode="offline">
                        <i class="fas fa-wifi-slash"></i> Offline
                    </div>
                </div>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">
                        <i class="fas fa-user"></i> Usuario/Email
                    </label>
                    <input type="text" id="username" class="form-control" placeholder="Ingrese su usuario o email" required>
                    <div class="input-icon">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock"></i> Contraseña
                    </label>
                    <input type="password" id="password" class="form-control" placeholder="Ingrese su contraseña" required>
                    <div class="input-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <button type="button" class="password-toggle" id="toggle-password">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="form-group">
                    <label for="role">
                        <i class="fas fa-user-tag"></i> Tipo de Usuario
                    </label>
                    <select id="role" class="form-control" required>
                        <option value="">Seleccione un rol</option>
                        <option value="admin">Administrador</option>
                        <option value="plantel">Plantel</option>
                        <option value="director">Director</option>
                        <option value="docente">Docente</option>
                        <option value="participante">Participante</option>
                    </select>
                </div>
                <button type="submit" class="btn-primary w-full">
                    <i class="fas fa-sign-in-alt"></i>
                    Iniciar Sesión
                </button>
                <div class="login-footer text-center mt-3">
                    <p><i class="fas fa-shield-alt"></i> Sistema Seguro | Acceso Restringido</p>
                    <p class="version">Versión 3.1.0 | © 2024 Complejo Virtual EPE</p>
                </div>
            </form>
        </div>
    </div>

    <!-- ===== DASHBOARD ADMINISTRADOR ===== -->
    <div id="admin-dashboard" class="dashboard-container hidden">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="logo-mini">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="header-title">
                    <h1>Panel de Administración</h1>
                </div>
            </div>
            <div class="header-right">
                <a href="https://github.com/BEATMORTISX/ComplejoVirtualEPE.git" target="_blank" class="github-btn hidden" id="github-btn-admin">
                    <i class="fab fa-github"></i> GitHub
                </a>
                <button id="back-to-admin-btn" class="btn btn-secondary hidden">
                    <i class="fas fa-arrow-left"></i> Volver al Admin
                </button>
                <button id="repair-system-btn" class="btn repair-btn">
                    <i class="fas fa-tools"></i> Reparar
                </button>
                <div class="user-info">
                    <div class="user-avatar" id="admin-avatar">A</div>
                    <div class="user-details">
                        <h4 id="admin-name">Administrador Principal</h4>
                        <small>Administrador</small>
                    </div>
                </div>
                <button id="logout-btn" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
        </div>
        
        <div class="dashboard-content">
            <nav class="dashboard-nav">
                <div class="nav-section">
                    <div class="nav-title">Principal</div>
                    <div class="nav-item active" data-section="dashboard">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="nav-item" data-section="mi-perfil">
                        <i class="fas fa-user"></i>
                        <span>Mi Perfil</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Gestión</div>
                    <div class="nav-item" data-section="planteles">
                        <i class="fas fa-school"></i>
                        <span>Planteles</span>
                    </div>
                    <div class="nav-item" data-section="directores">
                        <i class="fas fa-user-tie"></i>
                        <span>Directores</span>
                    </div>
                    <div class="nav-item" data-section="docentes">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>Docentes</span>
                    </div>
                    <div class="nav-item" data-section="participantes">
                        <i class="fas fa-users"></i>
                        <span>Participantes</span>
                    </div>
                    <div class="nav-item" data-section="formaciones">
                        <i class="fas fa-book-open"></i>
                        <span>Formaciones</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Sistema</div>
                    <div class="nav-item" data-section="usuarios">
                        <i class="fas fa-user-cog"></i>
                        <span>Usuarios</span>
                    </div>
                    <div class="nav-item" data-section="configuracion">
                        <i class="fas fa-cog"></i>
                        <span>Configuración</span>
                    </div>
                    <div class="nav-item" id="sync-now-btn">
                        <i class="fas fa-sync-alt"></i>
                        <span>Sincronizar</span>
                    </div>
                </div>
            </nav>
            
            <main class="content-area">
                <!-- Dashboard Principal -->
                <div id="section-dashboard" class="content-section">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-primary);">
                                <i class="fas fa-school"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-planteles">0</h3>
                                <p>Planteles</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-secondary);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-participantes">0</h3>
                                <p>Participantes</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-warning);">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-docentes">0</h3>
                                <p>Docentes</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-danger);">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-formaciones">0</h3>
                                <p>Formaciones</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Acceso Rápido</h3>
                        </div>
                        <div class="flex gap-2 flex-wrap">
                            <button class="btn btn-primary" onclick="accederInterfaz('plantel')">
                                <i class="fas fa-school"></i> Ver Plantel
                            </button>
                            <button class="btn btn-primary" onclick="accederInterfaz('director')">
                                <i class="fas fa-user-tie"></i> Ver Director
                            </button>
                            <button class="btn btn-primary" onclick="accederInterfaz('docente')">
                                <i class="fas fa-chalkboard-teacher"></i> Ver Docente
                            </button>
                            <button class="btn btn-primary" onclick="accederInterfaz('participante')">
                                <i class="fas fa-user-graduate"></i> Ver Participante
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Mi Perfil -->
                <div id="section-mi-perfil" class="content-section hidden">
                    <div class="card">
                        <div class="card-header">
                            <h3>Mi Perfil - Administrador</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Nombre Completo</label>
                                <input type="text" id="admin-profile-name" class="form-control" value="Administrador Principal">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="admin-profile-email" class="form-control" value="pabloemiliorico24@gmail.com">
                            </div>
                            <div class="form-group">
                                <label>Contraseña Actual</label>
                                <input type="password" id="admin-current-password" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Nueva Contraseña</label>
                                <input type="password" id="admin-new-password" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Confirmar Contraseña</label>
                                <input type="password" id="admin-confirm-password" class="form-control">
                            </div>
                        </div>
                        <button class="btn btn-success mt-3" onclick="guardarPerfilAdmin()">
                            <i class="fas fa-save"></i> Guardar Cambios
                        </button>
                    </div>
                </div>
                
                <!-- Gestión de Planteles -->
                <div id="section-planteles" class="content-section hidden">
                    <div class="card-header">
                        <h2>Gestión de Planteles</h2>
                        <button class="btn btn-primary" onclick="openModal('modal-plantel')">
                            <i class="fas fa-plus"></i> Nuevo Plantel
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-planteles">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Código Dependencia</th>
                                        <th>Código Plantel</th>
                                        <th>Nombre</th>
                                        <th>Ciudad</th>
                                        <th>Director</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Los datos se cargan dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Gestión de Directores -->
                <div id="section-directores" class="content-section hidden">
                    <div class="card-header">
                        <h2>Gestión de Directores</h2>
                        <button class="btn btn-primary" onclick="openModal('modal-director')">
                            <i class="fas fa-plus"></i> Nuevo Director
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-directores">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Email</th>
                                        <th>Teléfono</th>
                                        <th>Plantel</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Los datos se cargan dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Gestión de Docentes -->
                <div id="section-docentes" class="content-section hidden">
                    <div class="card-header">
                        <h2>Gestión de Docentes</h2>
                        <button class="btn btn-primary" onclick="openModal('modal-docente')">
                            <i class="fas fa-plus"></i> Nuevo Docente
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-docentes">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Especialidad</th>
                                        <th>Email</th>
                                        <th>Plantel</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Los datos se cargan dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Gestión de Participantes -->
                <div id="section-participantes" class="content-section hidden">
                    <div class="card-header">
                        <h2>Gestión de Participantes</h2>
                        <button class="btn btn-primary" onclick="openModal('modal-participante')">
                            <i class="fas fa-plus"></i> Nuevo Participante
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-participantes">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Edad</th>
                                        <th>Email</th>
                                        <th>Formación</th>
                                        <th>Plantel</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Los datos se cargan dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Gestión de Formaciones -->
                <div id="section-formaciones" class="content-section hidden">
                    <div class="card-header">
                        <h2>Gestión de Formaciones</h2>
                        <button class="btn btn-primary" onclick="openModal('modal-formacion')">
                            <i class="fas fa-plus"></i> Nueva Formación
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-formaciones">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Código</th>
                                        <th>Nombre</th>
                                        <th>Duración</th>
                                        <th>Modalidad</th>
                                        <th>Docente</th>
                                        <th>Plantel</th>
                                        <th>Vacantes</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Los datos se cargan dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Gestión de Usuarios -->
                <div id="section-usuarios" class="content-section hidden">
                    <div class="card-header">
                        <h2>Gestión de Usuarios</h2>
                        <button class="btn btn-primary" onclick="openModal('modal-usuario')">
                            <i class="fas fa-plus"></i> Nuevo Usuario
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-usuarios">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Usuario</th>
                                        <th>Nombre</th>
                                        <th>Rol</th>
                                        <th>Email</th>
                                        <th>Entidad</th>
                                        <th>Estado</th>
                                        <th>Último Acceso</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Los datos se cargan dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Configuración -->
                <div id="section-configuracion" class="content-section hidden">
                    <h2>Configuración del Sistema</h2>
                    
                    <div class="card">
                        <h3>Configuración General</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Intervalo de Actualización (segundos)</label>
                                <input type="number" id="intervalo-actualizacion" value="60" min="30" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Frecuencia de Backup</label>
                                <select id="frecuencia-backup" class="form-control">
                                    <option value="daily">Diario</option>
                                    <option value="weekly">Semanal</option>
                                    <option value="monthly">Mensual</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary mt-3" onclick="guardarConfiguracion()">
                            <i class="fas fa-save"></i> Guardar Configuración
                        </button>
                    </div>
                    
                    <div class="card">
                        <h3>Mantenimiento del Sistema</h3>
                        <div class="flex gap-2 flex-wrap">
                            <button class="btn btn-warning" onclick="repararSistema()">
                                <i class="fas fa-tools"></i> Reparar Sistema
                            </button>
                            <button class="btn btn-info" onclick="cargarVersionAnterior()">
                                <i class="fas fa-history"></i> Cargar Versión Anterior
                            </button>
                            <button class="btn btn-success" onclick="actualizarDesdeGitHub()">
                                <i class="fas fa-sync-alt"></i> Actualizar desde GitHub
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ===== DASHBOARD PLANTEL ===== -->
    <div id="plantel-dashboard" class="dashboard-container hidden">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="logo-mini">
                    <i class="fas fa-school"></i>
                </div>
                <div class="header-title">
                    <h1>Panel de Plantel</h1>
                </div>
            </div>
            <div class="header-right">
                <button id="back-to-admin-btn-plantel" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Volver al Admin
                </button>
                <div class="user-info">
                    <div class="user-avatar" id="plantel-avatar">P</div>
                    <div class="user-details">
                        <h4 id="plantel-name">Plantel</h4>
                        <small>Plantel</small>
                    </div>
                </div>
                <button id="logout-btn-plantel" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
        </div>
        
        <div class="dashboard-content">
            <nav class="dashboard-nav">
                <div class="nav-section">
                    <div class="nav-title">Principal</div>
                    <div class="nav-item active" data-section="dashboard-plantel">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="nav-item" data-section="mi-perfil-plantel">
                        <i class="fas fa-user"></i>
                        <span>Mi Perfil</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Gestión</div>
                    <div class="nav-item" data-section="directores-plantel">
                        <i class="fas fa-user-tie"></i>
                        <span>Directores</span>
                    </div>
                    <div class="nav-item" data-section="docentes-plantel">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>Docentes</span>
                    </div>
                    <div class="nav-item" data-section="participantes-plantel">
                        <i class="fas fa-users"></i>
                        <span>Participantes</span>
                    </div>
                    <div class="nav-item" data-section="formaciones-plantel">
                        <i class="fas fa-book-open"></i>
                        <span>Formaciones</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Acciones</div>
                    <div class="nav-item" onclick="openModalPlantel('modal-nuevo-docente')">
                        <i class="fas fa-plus"></i>
                        <span>Nuevo Docente</span>
                    </div>
                    <div class="nav-item" onclick="openModalPlantel('modal-nueva-formacion')">
                        <i class="fas fa-plus"></i>
                        <span>Nueva Formación</span>
                    </div>
                    <div class="nav-item" onclick="openModalPlantel('modal-nuevo-participante')">
                        <i class="fas fa-plus"></i>
                        <span>Nuevo Participante</span>
                    </div>
                </div>
            </nav>
            
            <main class="content-area">
                <!-- Dashboard Plantel -->
                <div id="section-dashboard-plantel" class="content-section">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-secondary);">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-directores-plantel">0</h3>
                                <p>Directores</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-warning);">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-docentes-plantel">0</h3>
                                <p>Docentes</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-primary);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-participantes-plantel">0</h3>
                                <p>Participantes</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-danger);">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-formaciones-plantel">0</h3>
                                <p>Formaciones</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>Información del Plantel</h3>
                        <div id="info-plantel-detalle">
                            <!-- Se carga dinámicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Mi Perfil Plantel -->
                <div id="section-mi-perfil-plantel" class="content-section hidden">
                    <div class="card">
                        <div class="card-header">
                            <h3>Mi Perfil - Plantel</h3>
                        </div>
                        <div id="perfil-plantel-detalle">
                            <!-- Se carga dinámicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Directores del Plantel -->
                <div id="section-directores-plantel" class="content-section hidden">
                    <div class="card-header">
                        <h2>Directores del Plantel</h2>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-directores-plantel">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Email</th>
                                        <th>Teléfono</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Docentes del Plantel -->
                <div id="section-docentes-plantel" class="content-section hidden">
                    <div class="card-header">
                        <h2>Docentes del Plantel</h2>
                        <button class="btn btn-primary" onclick="openModalPlantel('modal-nuevo-docente')">
                            <i class="fas fa-plus"></i> Nuevo Docente
                        </button>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-docentes-plantel">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Especialidad</th>
                                        <th>Email</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Participantes del Plantel -->
                <div id="section-participantes-plantel" class="content-section hidden">
                    <div class="card-header">
                        <h2>Participantes del Plantel</h2>
                        <button class="btn btn-primary" onclick="openModalPlantel('modal-nuevo-participante')">
                            <i class="fas fa-plus"></i> Nuevo Participante
                        </button>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-participantes-plantel">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Edad</th>
                                        <th>Email</th>
                                        <th>Formación</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Formaciones del Plantel -->
                <div id="section-formaciones-plantel" class="content-section hidden">
                    <div class="card-header">
                        <h2>Formaciones del Plantel</h2>
                        <button class="btn btn-primary" onclick="openModalPlantel('modal-nueva-formacion')">
                            <i class="fas fa-plus"></i> Nueva Formación
                        </button>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-formaciones-plantel">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Código</th>
                                        <th>Nombre</th>
                                        <th>Duración</th>
                                        <th>Modalidad</th>
                                        <th>Docente</th>
                                        <th>Vacantes</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ===== DASHBOARD DIRECTOR ===== -->
    <div id="director-dashboard" class="dashboard-container hidden">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="logo-mini">
                    <i class="fas fa-user-tie"></i>
                </div>
                <div class="header-title">
                    <h1>Panel de Director</h1>
                </div>
            </div>
            <div class="header-right">
                <button id="back-to-admin-btn-director" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Volver al Admin
                </button>
                <div class="user-info">
                    <div class="user-avatar" id="director-avatar">D</div>
                    <div class="user-details">
                        <h4 id="director-name">Director</h4>
                        <small>Director</small>
                    </div>
                </div>
                <button id="logout-btn-director" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
        </div>
        
        <div class="dashboard-content">
            <nav class="dashboard-nav">
                <div class="nav-section">
                    <div class="nav-title">Principal</div>
                    <div class="nav-item active" data-section="dashboard-director">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="nav-item" data-section="mi-perfil-director">
                        <i class="fas fa-user"></i>
                        <span>Mi Perfil</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Gestión</div>
                    <div class="nav-item" data-section="docentes-director">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>Docentes</span>
                    </div>
                    <div class="nav-item" data-section="participantes-director">
                        <i class="fas fa-users"></i>
                        <span>Participantes</span>
                    </div>
                    <div class="nav-item" data-section="formaciones-director">
                        <i class="fas fa-book-open"></i>
                        <span>Formaciones</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Acciones</div>
                    <div class="nav-item" onclick="openModalDirector('modal-nuevo-docente')">
                        <i class="fas fa-plus"></i>
                        <span>Nuevo Docente</span>
                    </div>
                    <div class="nav-item" onclick="openModalDirector('modal-nueva-formacion')">
                        <i class="fas fa-plus"></i>
                        <span>Nueva Formación</span>
                    </div>
                    <div class="nav-item" onclick="openModalDirector('modal-nuevo-participante')">
                        <i class="fas fa-plus"></i>
                        <span>Nuevo Participante</span>
                    </div>
                </div>
            </nav>
            
            <main class="content-area">
                <!-- Dashboard Director -->
                <div id="section-dashboard-director" class="content-section">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-warning);">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-docentes-director">0</h3>
                                <p>Docentes</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-primary);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-participantes-director">0</h3>
                                <p>Participantes</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-danger);">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-formaciones-director">0</h3>
                                <p>Formaciones</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>Información del Director</h3>
                        <div id="info-director-detalle">
                            <!-- Se carga dinámicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Mi Perfil Director -->
                <div id="section-mi-perfil-director" class="content-section hidden">
                    <div class="card">
                        <div class="card-header">
                            <h3>Mi Perfil - Director</h3>
                        </div>
                        <div id="perfil-director-detalle">
                            <!-- Se carga dinámicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Docentes del Director -->
                <div id="section-docentes-director" class="content-section hidden">
                    <div class="card-header">
                        <h2>Docentes del Plantel</h2>
                        <button class="btn btn-primary" onclick="openModalDirector('modal-nuevo-docente')">
                            <i class="fas fa-plus"></i> Nuevo Docente
                        </button>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-docentes-director">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Especialidad</th>
                                        <th>Email</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Participantes del Director -->
                <div id="section-participantes-director" class="content-section hidden">
                    <div class="card-header">
                        <h2>Participantes del Plantel</h2>
                        <button class="btn btn-primary" onclick="openModalDirector('modal-nuevo-participante')">
                            <i class="fas fa-plus"></i> Nuevo Participante
                        </button>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-participantes-director">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Edad</th>
                                        <th>Email</th>
                                        <th>Formación</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Formaciones del Director -->
                <div id="section-formaciones-director" class="content-section hidden">
                    <div class="card-header">
                        <h2>Formaciones del Plantel</h2>
                        <button class="btn btn-primary" onclick="openModalDirector('modal-nueva-formacion')">
                            <i class="fas fa-plus"></i> Nueva Formación
                        </button>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-formaciones-director">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Código</th>
                                        <th>Nombre</th>
                                        <th>Duración</th>
                                        <th>Modalidad</th>
                                        <th>Docente</th>
                                        <th>Vacantes</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ===== DASHBOARD DOCENTE ===== -->
    <div id="docente-dashboard" class="dashboard-container hidden">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="logo-mini">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <div class="header-title">
                    <h1>Panel de Docente</h1>
                </div>
            </div>
            <div class="header-right">
                <button id="back-to-admin-btn-docente" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Volver al Admin
                </button>
                <div class="user-info">
                    <div class="user-avatar" id="docente-avatar">D</div>
                    <div class="user-details">
                        <h4 id="docente-name">Docente</h4>
                        <small>Docente</small>
                    </div>
                </div>
                <button id="logout-btn-docente" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
        </div>
        
        <div class="dashboard-content">
            <nav class="dashboard-nav">
                <div class="nav-section">
                    <div class="nav-title">Principal</div>
                    <div class="nav-item active" data-section="dashboard-docente">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="nav-item" data-section="mi-perfil-docente">
                        <i class="fas fa-user"></i>
                        <span>Mi Perfil</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Gestión</div>
                    <div class="nav-item" data-section="formaciones-docente">
                        <i class="fas fa-book-open"></i>
                        <span>Mis Formaciones</span>
                    </div>
                    <div class="nav-item" data-section="participantes-docente">
                        <i class="fas fa-users"></i>
                        <span>Mis Participantes</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Acciones</div>
                    <div class="nav-item" onclick="openModalDocente('modal-nuevo-participante')">
                        <i class="fas fa-plus"></i>
                        <span>Añadir Participante</span>
                    </div>
                </div>
            </nav>
            
            <main class="content-area">
                <!-- Dashboard Docente -->
                <div id="section-dashboard-docente" class="content-section">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-danger);">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-formaciones-docente">0</h3>
                                <p>Formaciones</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-primary);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-participantes-docente">0</h3>
                                <p>Participantes</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>Información del Docente</h3>
                        <div id="info-docente-detalle">
                            <!-- Se carga dinámicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Mi Perfil Docente -->
                <div id="section-mi-perfil-docente" class="content-section hidden">
                    <div class="card">
                        <div class="card-header">
                            <h3>Mi Perfil - Docente</h3>
                        </div>
                        <div id="perfil-docente-detalle">
                            <!-- Se carga dinámicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Formaciones del Docente -->
                <div id="section-formaciones-docente" class="content-section hidden">
                    <div class="card-header">
                        <h2>Mis Formaciones</h2>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-formaciones-docente">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Código</th>
                                        <th>Nombre</th>
                                        <th>Duración</th>
                                        <th>Modalidad</th>
                                        <th>Vacantes</th>
                                        <th>Participantes</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Participantes del Docente -->
                <div id="section-participantes-docente" class="content-section hidden">
                    <div class="card-header">
                        <h2>Mis Participantes</h2>
                        <button class="btn btn-primary" onclick="openModalDocente('modal-nuevo-participante')">
                            <i class="fas fa-plus"></i> Añadir Participante
                        </button>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-participantes-docente">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cédula</th>
                                        <th>Nombre</th>
                                        <th>Edad</th>
                                        <th>Email</th>
                                        <th>Formación</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ===== DASHBOARD PARTICIPANTE ===== -->
    <div id="participante-dashboard" class="dashboard-container hidden">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="logo-mini">
                    <i class="fas fa-user-graduate"></i>
                </div>
                <div class="header-title">
                    <h1>Panel de Participante</h1>
                </div>
            </div>
            <div class="header-right">
                <button id="back-to-admin-btn-participante" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Volver al Admin
                </button>
                <div class="user-info">
                    <div class="user-avatar" id="participante-avatar">P</div>
                    <div class="user-details">
                        <h4 id="participante-name">Participante</h4>
                        <small>Participante</small>
                    </div>
                </div>
                <button id="logout-btn-participante" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
        </div>
        
        <div class="dashboard-content">
            <nav class="dashboard-nav">
                <div class="nav-section">
                    <div class="nav-title">Principal</div>
                    <div class="nav-item active" data-section="dashboard-participante">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="nav-item" data-section="mi-perfil-participante">
                        <i class="fas fa-user"></i>
                        <span>Mi Perfil</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Formaciones</div>
                    <div class="nav-item" data-section="mis-formaciones">
                        <i class="fas fa-book-open"></i>
                        <span>Mis Formaciones</span>
                    </div>
                    <div class="nav-item" data-section="inscribirse-formacion">
                        <i class="fas fa-pen-alt"></i>
                        <span>Inscribirse a Nueva Formación</span>
                    </div>
                </div>
            </nav>
            
            <main class="content-area">
                <!-- Dashboard Participante -->
                <div id="section-dashboard-participante" class="content-section">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-danger);">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-mis-formaciones">0</h3>
                                <p>Formaciones Inscritas</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--gradient-success);">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-formaciones-disponibles">0</h3>
                                <p>Formaciones Disponibles</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>Mi Información</h3>
                        <div id="info-participante-detalle">
                            <!-- Se carga dinámicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Mi Perfil Participante -->
                <div id="section-mi-perfil-participante" class="content-section hidden">
                    <div class="card">
                        <div class="card-header">
                            <h3>Mi Perfil - Participante</h3>
                        </div>
                        <div id="perfil-participante-detalle">
                            <!-- Se carga dinámicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Mis Formaciones -->
                <div id="section-mis-formaciones" class="content-section hidden">
                    <div class="card-header">
                        <h2>Mis Formaciones</h2>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-mis-formaciones">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Código</th>
                                        <th>Nombre</th>
                                        <th>Duración</th>
                                        <th>Modalidad</th>
                                        <th>Docente</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Inscribirse a Formación -->
                <div id="section-inscribirse-formacion" class="content-section hidden">
                    <div class="card-header">
                        <h2>Inscribirse a Nueva Formación</h2>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="tabla-formaciones-disponibles">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Código</th>
                                        <th>Nombre</th>
                                        <th>Duración</th>
                                        <th>Modalidad</th>
                                        <th>Docente</th>
                                        <th>Vacantes</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ===== MODALES ===== -->
    <!-- Modal para Nuevo Plantel -->
    <div id="modal-plantel" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo Plantel</h3>
                <button class="close-modal" onclick="closeModal('modal-plantel')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-plantel">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Código de Dependencia *</label>
                            <input type="text" id="plantel-codigo-dependencia" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Código de Plantel *</label>
                            <input type="text" id="plantel-codigo-plantel" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Nombre del Plantel *</label>
                            <input type="text" id="plantel-nombre" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Dirección *</label>
                            <input type="text" id="plantel-direccion" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Ciudad *</label>
                            <input type="text" id="plantel-ciudad" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Teléfono</label>
                            <input type="tel" id="plantel-telefono" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="plantel-email" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Director Asignado</label>
                            <select id="plantel-director" class="form-control">
                                <option value="">Seleccionar Director</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-plantel')">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarPlantel()">Guardar Plantel</button>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Plantel -->
    <div id="modal-editar-plantel" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Plantel</h3>
                <button class="close-modal" onclick="closeModal('modal-editar-plantel')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-editar-plantel">
                    <input type="hidden" id="editar-plantel-id">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Código de Dependencia *</label>
                            <input type="text" id="editar-plantel-codigo-dependencia" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Código de Plantel *</label>
                            <input type="text" id="editar-plantel-codigo-plantel" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Nombre del Plantel *</label>
                            <input type="text" id="editar-plantel-nombre" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Dirección *</label>
                            <input type="text" id="editar-plantel-direccion" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Ciudad *</label>
                            <input type="text" id="editar-plantel-ciudad" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Teléfono</label>
                            <input type="tel" id="editar-plantel-telefono" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="editar-plantel-email" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Director Asignado</label>
                            <select id="editar-plantel-director" class="form-control">
                                <option value="">Seleccionar Director</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-editar-plantel')">Cancelar</button>
                <button class="btn btn-primary" onclick="actualizarPlantel()">Actualizar Plantel</button>
            </div>
        </div>
    </div>

    <!-- Modal para Nuevo Director -->
    <div id="modal-director" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo Director</h3>
                <button class="close-modal" onclick="closeModal('modal-director')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-director">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Cédula *</label>
                            <input type="text" id="director-cedula" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Nombres *</label>
                            <input type="text" id="director-nombres" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos *</label>
                            <input type="text" id="director-apellidos" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Teléfono *</label>
                            <input type="tel" id="director-telefono" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="director-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Plantel Asignado *</label>
                            <select id="director-plantel" class="form-control" required>
                                <option value="">Seleccione un plantel</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-director')">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarDirector()">Guardar Director</button>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Director -->
    <div id="modal-editar-director" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Director</h3>
                <button class="close-modal" onclick="closeModal('modal-editar-director')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-editar-director">
                    <input type="hidden" id="editar-director-id">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Cédula *</label>
                            <input type="text" id="editar-director-cedula" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Nombres *</label>
                            <input type="text" id="editar-director-nombres" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos *</label>
                            <input type="text" id="editar-director-apellidos" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Teléfono *</label>
                            <input type="tel" id="editar-director-telefono" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="editar-director-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Plantel Asignado *</label>
                            <select id="editar-director-plantel" class="form-control" required>
                                <option value="">Seleccione un plantel</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-editar-director')">Cancelar</button>
                <button class="btn btn-primary" onclick="actualizarDirector()">Actualizar Director</button>
            </div>
        </div>
    </div>

    <!-- Modal para Nuevo Docente -->
    <div id="modal-docente" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo Docente</h3>
                <button class="close-modal" onclick="closeModal('modal-docente')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-docente">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Cédula *</label>
                            <input type="text" id="docente-cedula" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Nombres *</label>
                            <input type="text" id="docente-nombres" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos *</label>
                            <input type="text" id="docente-apellidos" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Especialidad *</label>
                            <input type="text" id="docente-especialidad" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Teléfono *</label>
                            <input type="tel" id="docente-telefono" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="docente-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Plantel *</label>
                            <select id="docente-plantel" class="form-control" required>
                                <option value="">Seleccione un plantel</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-docente')">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarDocente()">Guardar Docente</button>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Docente -->
    <div id="modal-editar-docente" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Docente</h3>
                <button class="close-modal" onclick="closeModal('modal-editar-docente')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-editar-docente">
                    <input type="hidden" id="editar-docente-id">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Cédula *</label>
                            <input type="text" id="editar-docente-cedula" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Nombres *</label>
                            <input type="text" id="editar-docente-nombres" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos *</label>
                            <input type="text" id="editar-docente-apellidos" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Especialidad *</label>
                            <input type="text" id="editar-docente-especialidad" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Teléfono *</label>
                            <input type="tel" id="editar-docente-telefono" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="editar-docente-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Plantel *</label>
                            <select id="editar-docente-plantel" class="form-control" required>
                                <option value="">Seleccione un plantel</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-editar-docente')">Cancelar</button>
                <button class="btn btn-primary" onclick="actualizarDocente()">Actualizar Docente</button>
            </div>
        </div>
    </div>

    <!-- Modal para Nuevo Participante -->
    <div id="modal-participante" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo Participante</h3>
                <button class="close-modal" onclick="closeModal('modal-participante')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-participante">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nombres *</label>
                            <input type="text" id="participante-nombres" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos *</label>
                            <input type="text" id="participante-apellidos" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Cédula *</label>
                            <input type="text" id="participante-cedula" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Teléfono *</label>
                            <input type="tel" id="participante-telefono" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Correo Electrónico *</label>
                            <input type="email" id="participante-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Edad *</label>
                            <input type="number" id="participante-edad" class="form-control" required min="16">
                        </div>
                        <div class="form-group">
                            <label>Sexo *</label>
                            <select id="participante-sexo" class="form-control" required>
                                <option value="">Seleccionar</option>
                                <option value="masculino">Masculino</option>
                                <option value="femenino">Femenino</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Fecha de Nacimiento *</label>
                            <input type="date" id="participante-fecha-nacimiento" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Lugar de Nacimiento *</label>
                            <input type="text" id="participante-lugar-nacimiento" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Parroquia donde vive *</label>
                            <input type="text" id="participante-parroquia" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Dirección de Habitación *</label>
                            <input type="text" id="participante-direccion" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>¿Posée alguna discapacidad? *</label>
                            <select id="participante-discapacidad" class="form-control" required onchange="toggleDiscapacidad()">
                                <option value="">Seleccionar</option>
                                <option value="no">No</option>
                                <option value="si">Sí</option>
                            </select>
                        </div>
                        <div class="form-group" id="discapacidad-detalle" style="display: none;">
                            <label>Indicar Discapacidad</label>
                            <input type="text" id="participante-discapacidad-detalle" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Talla de Camisa</label>
                            <input type="text" id="participante-talla-camisa" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Peso (kg)</label>
                            <input type="number" id="participante-peso" class="form-control" min="0">
                        </div>
                        <div class="form-group">
                            <label>Talla de Pantalón</label>
                            <input type="text" id="participante-talla-pantalon" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Talla de Zapato</label>
                            <input type="number" id="participante-talla-zapato" class="form-control" min="0">
                        </div>
                        <div class="form-group">
                            <label>Ocupación Actual</label>
                            <input type="text" id="participante-ocupacion" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Grado de Instrucción *</label>
                            <select id="participante-grado-instruccion" class="form-control" required>
                                <option value="">Seleccionar</option>
                                <option value="primaria">Primaria</option>
                                <option value="bachiller">Bachiller</option>
                                <option value="tecnico">Técnico</option>
                                <option value="universitario">Universitario</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Formación a Inscribir *</label>
                            <select id="participante-formacion" class="form-control" required>
                                <option value="">Seleccionar Formación</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Docente Responsable *</label>
                            <select id="participante-docente" class="form-control" required>
                                <option value="">Seleccionar Docente</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Plantel *</label>
                            <select id="participante-plantel" class="form-control" required>
                                <option value="">Seleccionar Plantel</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-participante')">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarParticipante()">Guardar Participante</button>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Participante -->
    <div id="modal-editar-participante" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Participante</h3>
                <button class="close-modal" onclick="closeModal('modal-editar-participante')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-editar-participante">
                    <input type="hidden" id="editar-participante-id">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nombres *</label>
                            <input type="text" id="editar-participante-nombres" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos *</label>
                            <input type="text" id="editar-participante-apellidos" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Cédula *</label>
                            <input type="text" id="editar-participante-cedula" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Teléfono *</label>
                            <input type="tel" id="editar-participante-telefono" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Correo Electrónico *</label>
                            <input type="email" id="editar-participante-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Edad *</label>
                            <input type="number" id="editar-participante-edad" class="form-control" required min="16">
                        </div>
                        <div class="form-group">
                            <label>Sexo *</label>
                            <select id="editar-participante-sexo" class="form-control" required>
                                <option value="">Seleccionar</option>
                                <option value="masculino">Masculino</option>
                                <option value="femenino">Femenino</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Fecha de Nacimiento *</label>
                            <input type="date" id="editar-participante-fecha-nacimiento" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Lugar de Nacimiento *</label>
                            <input type="text" id="editar-participante-lugar-nacimiento" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Parroquia donde vive *</label>
                            <input type="text" id="editar-participante-parroquia" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Dirección de Habitación *</label>
                            <input type="text" id="editar-participante-direccion" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>¿Posée alguna discapacidad? *</label>
                            <select id="editar-participante-discapacidad" class="form-control" required onchange="toggleDiscapacidadEditar()">
                                <option value="">Seleccionar</option>
                                <option value="no">No</option>
                                <option value="si">Sí</option>
                            </select>
                        </div>
                        <div class="form-group" id="editar-discapacidad-detalle" style="display: none;">
                            <label>Indicar Discapacidad</label>
                            <input type="text" id="editar-participante-discapacidad-detalle" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Talla de Camisa</label>
                            <input type="text" id="editar-participante-talla-camisa" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Peso (kg)</label>
                            <input type="number" id="editar-participante-peso" class="form-control" min="0">
                        </div>
                        <div class="form-group">
                            <label>Talla de Pantalón</label>
                            <input type="text" id="editar-participante-talla-pantalon" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Talla de Zapato</label>
                            <input type="number" id="editar-participante-talla-zapato" class="form-control" min="0">
                        </div>
                        <div class="form-group">
                            <label>Ocupación Actual</label>
                            <input type="text" id="editar-participante-ocupacion" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Grado de Instrucción *</label>
                            <select id="editar-participante-grado-instruccion" class="form-control" required>
                                <option value="">Seleccionar</option>
                                <option value="primaria">Primaria</option>
                                <option value="bachiller">Bachiller</option>
                                <option value="tecnico">Técnico</option>
                                <option value="universitario">Universitario</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Formación a Inscribir *</label>
                            <select id="editar-participante-formacion" class="form-control" required>
                                <option value="">Seleccionar Formación</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Docente Responsable *</label>
                            <select id="editar-participante-docente" class="form-control" required>
                                <option value="">Seleccionar Docente</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Plantel *</label>
                            <select id="editar-participante-plantel" class="form-control" required>
                                <option value="">Seleccionar Plantel</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-editar-participante')">Cancelar</button>
                <button class="btn btn-primary" onclick="actualizarParticipante()">Actualizar Participante</button>
            </div>
        </div>
    </div>

    <!-- Modal para Nueva Formación -->
    <div id="modal-formacion" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nueva Formación</h3>
                <button class="close-modal" onclick="closeModal('modal-formacion')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-formacion">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Código *</label>
                            <input type="text" id="formacion-codigo" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Nombre *</label>
                            <input type="text" id="formacion-nombre" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Descripción</label>
                            <textarea id="formacion-descripcion" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Duración (horas) *</label>
                            <input type="number" id="formacion-duracion" class="form-control" required min="1">
                        </div>
                        <div class="form-group">
                            <label>Modalidad *</label>
                            <select id="formacion-modalidad" class="form-control" required>
                                <option value="">Seleccionar</option>
                                <option value="presencial">Presencial</option>
                                <option value="virtual">Virtual</option>
                                <option value="mixta">Mixta</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Docente *</label>
                            <select id="formacion-docente" class="form-control" required>
                                <option value="">Seleccionar Docente</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Plantel *</label>
                            <select id="formacion-plantel" class="form-control" required>
                                <option value="">Seleccionar Plantel</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Fecha Inicio *</label>
                            <input type="date" id="formacion-fecha-inicio" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Fecha Fin *</label>
                            <input type="date" id="formacion-fecha-fin" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Vacantes *</label>
                            <input type="number" id="formacion-vacantes" class="form-control" required min="1">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-formacion')">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarFormacion()">Guardar Formación</button>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Formación -->
    <div id="modal-editar-formacion" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Formación</h3>
                <button class="close-modal" onclick="closeModal('modal-editar-formacion')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-editar-formacion">
                    <input type="hidden" id="editar-formacion-id">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Código *</label>
                            <input type="text" id="editar-formacion-codigo" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Nombre *</label>
                            <input type="text" id="editar-formacion-nombre" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Descripción</label>
                            <textarea id="editar-formacion-descripcion" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Duración (horas) *</label>
                            <input type="number" id="editar-formacion-duracion" class="form-control" required min="1">
                        </div>
                        <div class="form-group">
                            <label>Modalidad *</label>
                            <select id="editar-formacion-modalidad" class="form-control" required>
                                <option value="">Seleccionar</option>
                                <option value="presencial">Presencial</option>
                                <option value="virtual">Virtual</option>
                                <option value="mixta">Mixta</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Docente *</label>
                            <select id="editar-formacion-docente" class="form-control" required>
                                <option value="">Seleccionar Docente</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Plantel *</label>
                            <select id="editar-formacion-plantel" class="form-control" required>
                                <option value="">Seleccionar Plantel</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Fecha Inicio *</label>
                            <input type="date" id="editar-formacion-fecha-inicio" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Fecha Fin *</label>
                            <input type="date" id="editar-formacion-fecha-fin" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Vacantes *</label>
                            <input type="number" id="editar-formacion-vacantes" class="form-control" required min="1">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-editar-formacion')">Cancelar</button>
                <button class="btn btn-primary" onclick="actualizarFormacion()">Actualizar Formación</button>
            </div>
        </div>
    </div>

    <!-- Modal para Nuevo Usuario -->
    <div id="modal-usuario" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo Usuario</h3>
                <button class="close-modal" onclick="closeModal('modal-usuario')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-usuario">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Rol *</label>
                            <select id="usuario-rol" class="form-control" required onchange="cambiarTipoUsuario()">
                                <option value="">Seleccionar Rol</option>
                                <option value="admin">Administrador</option>
                                <option value="plantel">Plantel</option>
                                <option value="director">Director</option>
                                <option value="docente">Docente</option>
                                <option value="participante">Participante</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Usuario *</label>
                            <input type="text" id="usuario-username" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Contraseña *</label>
                            <input type="password" id="usuario-password" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Confirmar Contraseña *</label>
                            <input type="password" id="usuario-confirm-password" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="usuario-email" class="form-control" required>
                        </div>
                        <div class="form-group" id="usuario-entidad-container" style="display: none;">
                            <label id="usuario-entidad-label">Entidad</label>
                            <select id="usuario-entidad" class="form-control">
                                <!-- Se llena dinámicamente según el rol -->
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-usuario')">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarUsuario()">Guardar Usuario</button>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Usuario -->
    <div id="modal-editar-usuario" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Usuario</h3>
                <button class="close-modal" onclick="closeModal('modal-editar-usuario')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-editar-usuario">
                    <input type="hidden" id="editar-usuario-id">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Rol *</label>
                            <select id="editar-usuario-rol" class="form-control" required onchange="cambiarTipoUsuarioEditar()">
                                <option value="">Seleccionar Rol</option>
                                <option value="admin">Administrador</option>
                                <option value="plantel">Plantel</option>
                                <option value="director">Director</option>
                                <option value="docente">Docente</option>
                                <option value="participante">Participante</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Usuario *</label>
                            <input type="text" id="editar-usuario-username" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Contraseña (dejar en blanco para no cambiar)</label>
                            <input type="password" id="editar-usuario-password" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Confirmar Contraseña</label>
                            <input type="password" id="editar-usuario-confirm-password" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="editar-usuario-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Estado *</label>
                            <select id="editar-usuario-estado" class="form-control" required>
                                <option value="activo">Activo</option>
                                <option value="inactivo">Inactivo</option>
                            </select>
                        </div>
                        <div class="form-group" id="editar-usuario-entidad-container" style="display: none;">
                            <label id="editar-usuario-entidad-label">Entidad</label>
                            <select id="editar-usuario-entidad" class="form-control">
                                <!-- Se llena dinámicamente según el rol -->
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modal-editar-usuario')">Cancelar</button>
                <button class="btn btn-primary" onclick="actualizarUsuario()">Actualizar Usuario</button>
            </div>
        </div>
    </div>

    <script>
        // ===== SISTEMA COMPLETO =====
        let datosSistema = {
            planteles: [],
            directores: [],
            docentes: [],
            participantes: [],
            formaciones: [],
            usuarios: [],
            configuracion: {
                intervaloActualizacion: 60,
                frecuenciaBackup: 'daily',
                modoConexion: 'online'
            }
        };

        let currentUser = null;
        let currentRole = null;
        let intervaloActualizacion = null;
        let modoConexion = 'online';
        let editandoId = null;

        // ===== INICIALIZACIÓN =====
        document.addEventListener('DOMContentLoaded', function() {
            cargarDatos();
            inicializarEventos();
            configurarModoConexion();
        });

        function cargarDatos() {
            const datosGuardados = localStorage.getItem('complejoVirtualEPE');
            if (datosGuardados) {
                datosSistema = JSON.parse(datosGuardados);
            } else {
                // Crear usuario administrador inicial
                datosSistema.usuarios = [{
                    id: 1,
                    username: 'pabloemiliorico24@gmail.com',
                    password: 'Perp.241',
                    email: 'pabloemiliorico24@gmail.com',
                    nombre: 'Administrador Principal',
                    rol: 'admin',
                    estado: 'activo',
                    ultimoAcceso: null
                }];
                guardarDatos();
            }
            actualizarEstadisticas();
        }

        function guardarDatos() {
            localStorage.setItem('complejoVirtualEPE', JSON.stringify(datosSistema));
        }

        // ===== EVENTOS =====
        function inicializarEventos() {
            // Login
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                login();
            });

            // Toggle password
            document.getElementById('toggle-password').addEventListener('click', function() {
                const passwordInput = document.getElementById('password');
                const icon = this.querySelector('i');
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.classList.replace('fa-eye', 'fa-eye-slash');
                } else {
                    passwordInput.type = 'password';
                    icon.classList.replace('fa-eye-slash', 'fa-eye');
                }
            });

            // Modo conexión
            document.querySelectorAll('.connection-mode-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.connection-mode-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    modoConexion = this.dataset.mode;
                    configurarModoConexion();
                });
            });

            // Logout
            document.querySelectorAll('[id^="logout-btn"]').forEach(btn => {
                btn.addEventListener('click', logout);
            });

            // Sincronizar
            document.getElementById('sync-now-btn')?.addEventListener('click', sincronizarDatos);

            // Reparar sistema
            document.getElementById('repair-system-btn')?.addEventListener('click', repararSistema);

            // Navegación
            document.querySelectorAll('.nav-item[data-section]').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.dataset.section;
                    switchSection(section);
                });
            });

            // Botones volver al admin
            document.querySelectorAll('[id^="back-to-admin-btn"]').forEach(btn => {
                btn.addEventListener('click', volverAlAdmin);
            });
        }

        // ===== LOGIN =====
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;

            if (!username || !password || !role) {
                showAlert('Por favor, complete todos los campos', 'error');
                return;
            }

            const usuario = datosSistema.usuarios.find(u => 
                (u.username === username || u.email === username) && 
                u.rol === role && 
                u.estado === 'activo'
            );

            if (!usuario) {
                showAlert('Usuario no encontrado o inactivo', 'error');
                return;
            }

            if (usuario.password !== password) {
                showAlert('Contraseña incorrecta', 'error');
                return;
            }

            // Actualizar último acceso
            usuario.ultimoAcceso = new Date().toISOString();
            guardarDatos();

            // Iniciar sesión
            currentUser = usuario;
            currentRole = role;

            // Mostrar dashboard correspondiente
            mostrarDashboard(role, usuario);

            showAlert(`¡Bienvenido, ${usuario.nombre}!`, 'success');
        }

        function mostrarDashboard(role, usuario) {
            // Ocultar login
            document.getElementById('login-container').classList.add('hidden');

            // Mostrar dashboard correspondiente
            const dashboardId = `${role}-dashboard`;
            document.getElementById(dashboardId).classList.remove('hidden');

            // Configurar interfaz
            configurarInterfaz(role, usuario);

            // Iniciar actualización automática
            iniciarActualizacionAutomatica();

            // Mostrar botón GitHub solo para admin
            if (role === 'admin') {
                document.getElementById('github-btn-admin').classList.remove('hidden');
            }
        }

        function configurarInterfaz(role, usuario) {
            switch(role) {
                case 'admin':
                    document.getElementById('admin-name').textContent = usuario.nombre;
                    document.getElementById('admin-avatar').textContent = usuario.nombre.charAt(0);
                    cargarSeccionAdmin('dashboard');
                    break;
                case 'plantel':
                    document.getElementById('plantel-name').textContent = usuario.nombre;
                    document.getElementById('plantel-avatar').textContent = usuario.nombre.charAt(0);
                    cargarSeccionPlantel('dashboard-plantel');
                    break;
                case 'director':
                    document.getElementById('director-name').textContent = usuario.nombre;
                    document.getElementById('director-avatar').textContent = usuario.nombre.charAt(0);
                    cargarSeccionDirector('dashboard-director');
                    break;
                case 'docente':
                    document.getElementById('docente-name').textContent = usuario.nombre;
                    document.getElementById('docente-avatar').textContent = usuario.nombre.charAt(0);
                    cargarSeccionDocente('dashboard-docente');
                    break;
                case 'participante':
                    document.getElementById('participante-name').textContent = usuario.nombre;
                    document.getElementById('participante-avatar').textContent = usuario.nombre.charAt(0);
                    cargarSeccionParticipante('dashboard-participante');
                    break;
            }
        }

        // ===== NAVEGACIÓN =====
        function switchSection(sectionId) {
            // Actualizar navegación activa
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const navItem = document.querySelector(`[data-section="${sectionId}"]`);
            if (navItem) {
                navItem.classList.add('active');
            }

            // Ocultar todas las secciones
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });

            // Mostrar sección seleccionada
            const seccion = document.getElementById(`section-${sectionId}`);
            if (seccion) {
                seccion.classList.remove('hidden');
            }

            // Cargar datos de la sección
            if (currentRole === 'admin') {
                cargarSeccionAdmin(sectionId);
            } else if (currentRole === 'plantel') {
                cargarSeccionPlantel(sectionId);
            } else if (currentRole === 'director') {
                cargarSeccionDirector(sectionId);
            } else if (currentRole === 'docente') {
                cargarSeccionDocente(sectionId);
            } else if (currentRole === 'participante') {
                cargarSeccionParticipante(sectionId);
            }
        }

        // ===== SECCIONES ADMIN =====
        function cargarSeccionAdmin(sectionId) {
            switch(sectionId) {
                case 'dashboard':
                    actualizarEstadisticas();
                    break;
                case 'planteles':
                    cargarPlanteles();
                    break;
                case 'directores':
                    cargarDirectores();
                    break;
                case 'docentes':
                    cargarDocentes();
                    break;
                case 'participantes':
                    cargarParticipantes();
                    break;
                case 'formaciones':
                    cargarFormaciones();
                    break;
                case 'usuarios':
                    cargarUsuarios();
                    break;
                case 'mi-perfil':
                    cargarPerfilAdmin();
                    break;
            }
        }

        function cargarPlanteles() {
            const tbody = document.querySelector('#tabla-planteles tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            datosSistema.planteles.forEach(plantel => {
                const director = datosSistema.directores.find(d => d.id === plantel.directorId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${plantel.id}</td>
                    <td>${plantel.codigoDependencia}</td>
                    <td>${plantel.codigoPlantel}</td>
                    <td>${plantel.nombre}</td>
                    <td>${plantel.ciudad}</td>
                    <td>${director ? `${director.nombres} ${director.apellidos}` : 'No asignado'}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarPlantel(${plantel.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-warning" onclick="accederInterfazPlantel(${plantel.id})">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarPlantel(${plantel.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarDirectores() {
            const tbody = document.querySelector('#tabla-directores tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            datosSistema.directores.forEach(director => {
                const plantel = datosSistema.planteles.find(p => p.id === director.plantelId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${director.id}</td>
                    <td>${director.cedula}</td>
                    <td>${director.nombres} ${director.apellidos}</td>
                    <td>${director.email}</td>
                    <td>${director.telefono}</td>
                    <td>${plantel ? plantel.nombre : 'No asignado'}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarDirector(${director.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarDirector(${director.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarDocentes() {
            const tbody = document.querySelector('#tabla-docentes tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            datosSistema.docentes.forEach(docente => {
                const plantel = datosSistema.planteles.find(p => p.id === docente.plantelId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${docente.id}</td>
                    <td>${docente.cedula}</td>
                    <td>${docente.nombres} ${docente.apellidos}</td>
                    <td>${docente.especialidad}</td>
                    <td>${docente.email}</td>
                    <td>${plantel ? plantel.nombre : 'No asignado'}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarDocente(${docente.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarDocente(${docente.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarParticipantes() {
            const tbody = document.querySelector('#tabla-participantes tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            datosSistema.participantes.forEach(participante => {
                const formacion = datosSistema.formaciones.find(f => f.id === participante.formacionId);
                const plantel = datosSistema.planteles.find(p => p.id === participante.plantelId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${participante.id}</td>
                    <td>${participante.cedula}</td>
                    <td>${participante.nombres} ${participante.apellidos}</td>
                    <td>${participante.edad}</td>
                    <td>${participante.email}</td>
                    <td>${formacion ? formacion.nombre : 'No asignado'}</td>
                    <td>${plantel ? plantel.nombre : 'No asignado'}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarParticipante(${participante.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarParticipante(${participante.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarFormaciones() {
            const tbody = document.querySelector('#tabla-formaciones tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            datosSistema.formaciones.forEach(formacion => {
                const docente = datosSistema.docentes.find(d => d.id === formacion.docenteId);
                const plantel = datosSistema.planteles.find(p => p.id === formacion.plantelId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formacion.id}</td>
                    <td>${formacion.codigo}</td>
                    <td>${formacion.nombre}</td>
                    <td>${formacion.duracion} horas</td>
                    <td>${formacion.modalidad}</td>
                    <td>${docente ? `${docente.nombres} ${docente.apellidos}` : 'No asignado'}</td>
                    <td>${plantel ? plantel.nombre : 'No asignado'}</td>
                    <td>${formacion.vacantes}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarFormacion(${formacion.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarFormacion(${formacion.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarUsuarios() {
            const tbody = document.querySelector('#tabla-usuarios tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            datosSistema.usuarios.forEach(usuario => {
                let entidadNombre = 'N/A';
                if (usuario.entidadId) {
                    switch(usuario.rol) {
                        case 'plantel':
                            const plantel = datosSistema.planteles.find(p => p.id === usuario.entidadId);
                            entidadNombre = plantel ? plantel.nombre : 'N/A';
                            break;
                        case 'director':
                            const director = datosSistema.directores.find(d => d.id === usuario.entidadId);
                            entidadNombre = director ? `${director.nombres} ${director.apellidos}` : 'N/A';
                            break;
                        case 'docente':
                            const docente = datosSistema.docentes.find(d => d.id === usuario.entidadId);
                            entidadNombre = docente ? `${docente.nombres} ${docente.apellidos}` : 'N/A';
                            break;
                        case 'participante':
                            const participante = datosSistema.participantes.find(p => p.id === usuario.entidadId);
                            entidadNombre = participante ? `${participante.nombres} ${participante.apellidos}` : 'N/A';
                            break;
                    }
                }
                
                const ultimoAcceso = usuario.ultimoAcceso ? new Date(usuario.ultimoAcceso).toLocaleString() : 'Nunca';
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${usuario.id}</td>
                    <td>${usuario.username}</td>
                    <td>${usuario.nombre}</td>
                    <td><span class="badge badge-info">${usuario.rol}</span></td>
                    <td>${usuario.email}</td>
                    <td>${entidadNombre}</td>
                    <td><span class="badge ${usuario.estado === 'activo' ? 'badge-success' : 'badge-danger'}">${usuario.estado}</span></td>
                    <td>${ultimoAcceso}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarUsuario(${usuario.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        ${usuario.id !== 1 ? `
                            <button class="btn btn-sm btn-danger" onclick="eliminarUsuario(${usuario.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        ` : ''}
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ===== SECCIONES PLANTEL =====
        function cargarSeccionPlantel(sectionId) {
            const plantelId = currentUser.entidadId;
            const plantel = datosSistema.planteles.find(p => p.id === plantelId);

            if (!plantel) {
                showAlert('Plantel no encontrado', 'error');
                return;
            }

            switch(sectionId) {
                case 'dashboard-plantel':
                    cargarEstadisticasPlantel(plantelId);
                    cargarInfoPlantel(plantel);
                    break;
                case 'mi-perfil-plantel':
                    cargarPerfilPlantel(plantel);
                    break;
                case 'directores-plantel':
                    cargarDirectoresPlantel(plantelId);
                    break;
                case 'docentes-plantel':
                    cargarDocentesPlantel(plantelId);
                    break;
                case 'participantes-plantel':
                    cargarParticipantesPlantel(plantelId);
                    break;
                case 'formaciones-plantel':
                    cargarFormacionesPlantel(plantelId);
                    break;
            }
        }

        function cargarEstadisticasPlantel(plantelId) {
            const directores = datosSistema.directores.filter(d => d.plantelId === plantelId).length;
            const docentes = datosSistema.docentes.filter(d => d.plantelId === plantelId).length;
            const participantes = datosSistema.participantes.filter(p => p.plantelId === plantelId).length;
            const formaciones = datosSistema.formaciones.filter(f => f.plantelId === plantelId).length;

            document.getElementById('stat-directores-plantel').textContent = directores;
            document.getElementById('stat-docentes-plantel').textContent = docentes;
            document.getElementById('stat-participantes-plantel').textContent = participantes;
            document.getElementById('stat-formaciones-plantel').textContent = formaciones;
        }

        function cargarInfoPlantel(plantel) {
            const director = datosSistema.directores.find(d => d.id === plantel.directorId);
            const infoDiv = document.getElementById('info-plantel-detalle');
            infoDiv.innerHTML = `
                <p><strong>Código Dependencia:</strong> ${plantel.codigoDependencia}</p>
                <p><strong>Código Plantel:</strong> ${plantel.codigoPlantel}</p>
                <p><strong>Nombre:</strong> ${plantel.nombre}</p>
                <p><strong>Dirección:</strong> ${plantel.direccion}, ${plantel.ciudad}</p>
                <p><strong>Teléfono:</strong> ${plantel.telefono}</p>
                <p><strong>Email:</strong> ${plantel.email}</p>
                <p><strong>Director:</strong> ${director ? `${director.nombres} ${director.apellidos}` : 'No asignado'}</p>
            `;
        }

        function cargarPerfilPlantel(plantel) {
            const div = document.getElementById('perfil-plantel-detalle');
            div.innerHTML = `
                <div class="form-grid">
                    <div class="form-group">
                        <label>Código Dependencia</label>
                        <input type="text" class="form-control" value="${plantel.codigoDependencia}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Código Plantel</label>
                        <input type="text" class="form-control" value="${plantel.codigoPlantel}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Nombre</label>
                        <input type="text" class="form-control" value="${plantel.nombre}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Dirección</label>
                        <input type="text" class="form-control" value="${plantel.direccion}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Ciudad</label>
                        <input type="text" class="form-control" value="${plantel.ciudad}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Teléfono</label>
                        <input type="text" class="form-control" value="${plantel.telefono || ''}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" class="form-control" value="${plantel.email || ''}" readonly>
                    </div>
                </div>
            `;
        }

        function cargarDirectoresPlantel(plantelId) {
            const tbody = document.querySelector('#tabla-directores-plantel tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const directores = datosSistema.directores.filter(d => d.plantelId === plantelId);
            directores.forEach(director => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${director.id}</td>
                    <td>${director.cedula}</td>
                    <td>${director.nombres} ${director.apellidos}</td>
                    <td>${director.email}</td>
                    <td>${director.telefono}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarDirectorDesdePlantel(${director.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarDocentesPlantel(plantelId) {
            const tbody = document.querySelector('#tabla-docentes-plantel tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const docentes = datosSistema.docentes.filter(d => d.plantelId === plantelId);
            docentes.forEach(docente => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${docente.id}</td>
                    <td>${docente.cedula}</td>
                    <td>${docente.nombres} ${docente.apellidos}</td>
                    <td>${docente.especialidad}</td>
                    <td>${docente.email}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarDocenteDesdePlantel(${docente.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarDocenteDesdePlantel(${docente.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarParticipantesPlantel(plantelId) {
            const tbody = document.querySelector('#tabla-participantes-plantel tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const participantes = datosSistema.participantes.filter(p => p.plantelId === plantelId);
            participantes.forEach(participante => {
                const formacion = datosSistema.formaciones.find(f => f.id === participante.formacionId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${participante.id}</td>
                    <td>${participante.cedula}</td>
                    <td>${participante.nombres} ${participante.apellidos}</td>
                    <td>${participante.edad}</td>
                    <td>${participante.email}</td>
                    <td>${formacion ? formacion.nombre : 'No asignado'}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarParticipanteDesdePlantel(${participante.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarParticipanteDesdePlantel(${participante.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarFormacionesPlantel(plantelId) {
            const tbody = document.querySelector('#tabla-formaciones-plantel tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const formaciones = datosSistema.formaciones.filter(f => f.plantelId === plantelId);
            formaciones.forEach(formacion => {
                const docente = datosSistema.docentes.find(d => d.id === formacion.docenteId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formacion.id}</td>
                    <td>${formacion.codigo}</td>
                    <td>${formacion.nombre}</td>
                    <td>${formacion.duracion} horas</td>
                    <td>${formacion.modalidad}</td>
                    <td>${docente ? `${docente.nombres} ${docente.apellidos}` : 'No asignado'}</td>
                    <td>${formacion.vacantes}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarFormacionDesdePlantel(${formacion.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarFormacionDesdePlantel(${formacion.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ===== SECCIONES DIRECTOR =====
        function cargarSeccionDirector(sectionId) {
            const directorId = currentUser.entidadId;
            const director = datosSistema.directores.find(d => d.id === directorId);

            if (!director) {
                showAlert('Director no encontrado', 'error');
                return;
            }

            const plantelId = director.plantelId;

            switch(sectionId) {
                case 'dashboard-director':
                    cargarEstadisticasDirector(plantelId);
                    cargarInfoDirector(director);
                    break;
                case 'mi-perfil-director':
                    cargarPerfilDirector(director);
                    break;
                case 'docentes-director':
                    cargarDocentesDirector(plantelId);
                    break;
                case 'participantes-director':
                    cargarParticipantesDirector(plantelId);
                    break;
                case 'formaciones-director':
                    cargarFormacionesDirector(plantelId);
                    break;
            }
        }

        function cargarEstadisticasDirector(plantelId) {
            const docentes = datosSistema.docentes.filter(d => d.plantelId === plantelId).length;
            const participantes = datosSistema.participantes.filter(p => p.plantelId === plantelId).length;
            const formaciones = datosSistema.formaciones.filter(f => f.plantelId === plantelId).length;

            document.getElementById('stat-docentes-director').textContent = docentes;
            document.getElementById('stat-participantes-director').textContent = participantes;
            document.getElementById('stat-formaciones-director').textContent = formaciones;
        }

        function cargarInfoDirector(director) {
            const plantel = datosSistema.planteles.find(p => p.id === director.plantelId);
            const infoDiv = document.getElementById('info-director-detalle');
            infoDiv.innerHTML = `
                <p><strong>Cédula:</strong> ${director.cedula}</p>
                <p><strong>Nombre:</strong> ${director.nombres} ${director.apellidos}</p>
                <p><strong>Teléfono:</strong> ${director.telefono}</p>
                <p><strong>Email:</strong> ${director.email}</p>
                <p><strong>Plantel:</strong> ${plantel ? plantel.nombre : 'No asignado'}</p>
            `;
        }

        function cargarPerfilDirector(director) {
            const plantel = datosSistema.planteles.find(p => p.id === director.plantelId);
            const div = document.getElementById('perfil-director-detalle');
            div.innerHTML = `
                <div class="form-grid">
                    <div class="form-group">
                        <label>Cédula</label>
                        <input type="text" class="form-control" value="${director.cedula}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Nombres</label>
                        <input type="text" class="form-control" value="${director.nombres}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Apellidos</label>
                        <input type="text" class="form-control" value="${director.apellidos}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Teléfono</label>
                        <input type="text" class="form-control" value="${director.telefono}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" class="form-control" value="${director.email}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Plantel</label>
                        <input type="text" class="form-control" value="${plantel ? plantel.nombre : 'No asignado'}" readonly>
                    </div>
                </div>
            `;
        }

        function cargarDocentesDirector(plantelId) {
            const tbody = document.querySelector('#tabla-docentes-director tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const docentes = datosSistema.docentes.filter(d => d.plantelId === plantelId);
            docentes.forEach(docente => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${docente.id}</td>
                    <td>${docente.cedula}</td>
                    <td>${docente.nombres} ${docente.apellidos}</td>
                    <td>${docente.especialidad}</td>
                    <td>${docente.email}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarDocenteDesdeDirector(${docente.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarDocenteDesdeDirector(${docente.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarParticipantesDirector(plantelId) {
            const tbody = document.querySelector('#tabla-participantes-director tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const participantes = datosSistema.participantes.filter(p => p.plantelId === plantelId);
            participantes.forEach(participante => {
                const formacion = datosSistema.formaciones.find(f => f.id === participante.formacionId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${participante.id}</td>
                    <td>${participante.cedula}</td>
                    <td>${participante.nombres} ${participante.apellidos}</td>
                    <td>${participante.edad}</td>
                    <td>${participante.email}</td>
                    <td>${formacion ? formacion.nombre : 'No asignado'}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarParticipanteDesdeDirector(${participante.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarParticipanteDesdeDirector(${participante.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarFormacionesDirector(plantelId) {
            const tbody = document.querySelector('#tabla-formaciones-director tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const formaciones = datosSistema.formaciones.filter(f => f.plantelId === plantelId);
            formaciones.forEach(formacion => {
                const docente = datosSistema.docentes.find(d => d.id === formacion.docenteId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formacion.id}</td>
                    <td>${formacion.codigo}</td>
                    <td>${formacion.nombre}</td>
                    <td>${formacion.duracion} horas</td>
                    <td>${formacion.modalidad}</td>
                    <td>${docente ? `${docente.nombres} ${docente.apellidos}` : 'No asignado'}</td>
                    <td>${formacion.vacantes}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarFormacionDesdeDirector(${formacion.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarFormacionDesdeDirector(${formacion.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ===== SECCIONES DOCENTE =====
        function cargarSeccionDocente(sectionId) {
            const docenteId = currentUser.entidadId;
            const docente = datosSistema.docentes.find(d => d.id === docenteId);

            if (!docente) {
                showAlert('Docente no encontrado', 'error');
                return;
            }

            switch(sectionId) {
                case 'dashboard-docente':
                    cargarEstadisticasDocente(docenteId);
                    cargarInfoDocente(docente);
                    break;
                case 'mi-perfil-docente':
                    cargarPerfilDocente(docente);
                    break;
                case 'formaciones-docente':
                    cargarFormacionesDocente(docenteId);
                    break;
                case 'participantes-docente':
                    cargarParticipantesDocente(docenteId);
                    break;
            }
        }

        function cargarEstadisticasDocente(docenteId) {
            const formaciones = datosSistema.formaciones.filter(f => f.docenteId === docenteId).length;
            const participantes = datosSistema.participantes.filter(p => p.docenteId === docenteId).length;

            document.getElementById('stat-formaciones-docente').textContent = formaciones;
            document.getElementById('stat-participantes-docente').textContent = participantes;
        }

        function cargarInfoDocente(docente) {
            const plantel = datosSistema.planteles.find(p => p.id === docente.plantelId);
            const infoDiv = document.getElementById('info-docente-detalle');
            infoDiv.innerHTML = `
                <p><strong>Cédula:</strong> ${docente.cedula}</p>
                <p><strong>Nombre:</strong> ${docente.nombres} ${docente.apellidos}</p>
                <p><strong>Especialidad:</strong> ${docente.especialidad}</p>
                <p><strong>Teléfono:</strong> ${docente.telefono}</p>
                <p><strong>Email:</strong> ${docente.email}</p>
                <p><strong>Plantel:</strong> ${plantel ? plantel.nombre : 'No asignado'}</p>
            `;
        }

        function cargarPerfilDocente(docente) {
            const plantel = datosSistema.planteles.find(p => p.id === docente.plantelId);
            const div = document.getElementById('perfil-docente-detalle');
            div.innerHTML = `
                <div class="form-grid">
                    <div class="form-group">
                        <label>Cédula</label>
                        <input type="text" class="form-control" value="${docente.cedula}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Nombres</label>
                        <input type="text" class="form-control" value="${docente.nombres}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Apellidos</label>
                        <input type="text" class="form-control" value="${docente.apellidos}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Especialidad</label>
                        <input type="text" class="form-control" value="${docente.especialidad}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Teléfono</label>
                        <input type="text" class="form-control" value="${docente.telefono}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" class="form-control" value="${docente.email}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Plantel</label>
                        <input type="text" class="form-control" value="${plantel ? plantel.nombre : 'No asignado'}" readonly>
                    </div>
                </div>
            `;
        }

        function cargarFormacionesDocente(docenteId) {
            const tbody = document.querySelector('#tabla-formaciones-docente tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const formaciones = datosSistema.formaciones.filter(f => f.docenteId === docenteId);
            formaciones.forEach(formacion => {
                const participantes = datosSistema.participantes.filter(p => p.formacionId === formacion.id).length;
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formacion.id}</td>
                    <td>${formacion.codigo}</td>
                    <td>${formacion.nombre}</td>
                    <td>${formacion.duracion} horas</td>
                    <td>${formacion.modalidad}</td>
                    <td>${formacion.vacantes}</td>
                    <td>${participantes}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarFormacionDesdeDocente(${formacion.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cargarParticipantesDocente(docenteId) {
            const tbody = document.querySelector('#tabla-participantes-docente tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const participantes = datosSistema.participantes.filter(p => p.docenteId === docenteId);
            participantes.forEach(participante => {
                const formacion = datosSistema.formaciones.find(f => f.id === participante.formacionId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${participante.id}</td>
                    <td>${participante.cedula}</td>
                    <td>${participante.nombres} ${participante.apellidos}</td>
                    <td>${participante.edad}</td>
                    <td>${participante.email}</td>
                    <td>${formacion ? formacion.nombre : 'No asignado'}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editarParticipanteDesdeDocente(${participante.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarParticipanteDesdeDocente(${participante.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ===== SECCIONES PARTICIPANTE =====
        function cargarSeccionParticipante(sectionId) {
            const participanteId = currentUser.entidadId;
            const participante = datosSistema.participantes.find(p => p.id === participanteId);

            if (!participante) {
                showAlert('Participante no encontrado', 'error');
                return;
            }

            switch(sectionId) {
                case 'dashboard-participante':
                    cargarEstadisticasParticipante(participanteId);
                    cargarInfoParticipante(participante);
                    break;
                case 'mi-perfil-participante':
                    cargarPerfilParticipante(participante);
                    break;
                case 'mis-formaciones':
                    cargarMisFormaciones(participanteId);
                    break;
                case 'inscribirse-formacion':
                    cargarFormacionesDisponibles(participante);
                    break;
            }
        }

        function cargarEstadisticasParticipante(participanteId) {
            const misFormaciones = datosSistema.participantes.filter(p => p.id === participanteId && p.formacionId).length;
            const formacionesDisponibles = datosSistema.formaciones.filter(f => f.vacantes > 0).length;

            document.getElementById('stat-mis-formaciones').textContent = misFormaciones;
            document.getElementById('stat-formaciones-disponibles').textContent = formacionesDisponibles;
        }

        function cargarInfoParticipante(participante) {
            const formacion = datosSistema.formaciones.find(f => f.id === participante.formacionId);
            const plantel = datosSistema.planteles.find(p => p.id === participante.plantelId);
            const docente = datosSistema.docentes.find(d => d.id === participante.docenteId);
            const infoDiv = document.getElementById('info-participante-detalle');
            infoDiv.innerHTML = `
                <p><strong>Cédula:</strong> ${participante.cedula}</p>
                <p><strong>Nombre:</strong> ${participante.nombres} ${participante.apellidos}</p>
                <p><strong>Edad:</strong> ${participante.edad}</p>
                <p><strong>Teléfono:</strong> ${participante.telefono}</p>
                <p><strong>Email:</strong> ${participante.email}</p>
                <p><strong>Formación:</strong> ${formacion ? formacion.nombre : 'No asignado'}</p>
                <p><strong>Plantel:</strong> ${plantel ? plantel.nombre : 'No asignado'}</p>
                <p><strong>Docente:</strong> ${docente ? `${docente.nombres} ${docente.apellidos}` : 'No asignado'}</p>
            `;
        }

        function cargarPerfilParticipante(participante) {
            const formacion = datosSistema.formaciones.find(f => f.id === participante.formacionId);
            const plantel = datosSistema.planteles.find(p => p.id === participante.plantelId);
            const docente = datosSistema.docentes.find(d => d.id === participante.docenteId);
            const div = document.getElementById('perfil-participante-detalle');
            div.innerHTML = `
                <div class="form-grid">
                    <div class="form-group">
                        <label>Cédula</label>
                        <input type="text" class="form-control" value="${participante.cedula}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Nombres</label>
                        <input type="text" class="form-control" value="${participante.nombres}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Apellidos</label>
                        <input type="text" class="form-control" value="${participante.apellidos}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Edad</label>
                        <input type="number" class="form-control" value="${participante.edad}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Teléfono</label>
                        <input type="text" class="form-control" value="${participante.telefono}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" class="form-control" value="${participante.email}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Formación</label>
                        <input type="text" class="form-control" value="${formacion ? formacion.nombre : 'No asignado'}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Plantel</label>
                        <input type="text" class="form-control" value="${plantel ? plantel.nombre : 'No asignado'}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Docente</label>
                        <input type="text" class="form-control" value="${docente ? `${docente.nombres} ${docente.apellidos}` : 'No asignado'}" readonly>
                    </div>
                </div>
            `;
        }

        function cargarMisFormaciones(participanteId) {
            const tbody = document.querySelector('#tabla-mis-formaciones tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const participante = datosSistema.participantes.find(p => p.id === participanteId);
            if (!participante || !participante.formacionId) return;
            
            const formacion = datosSistema.formaciones.find(f => f.id === participante.formacionId);
            if (!formacion) return;
            
            const docente = datosSistema.docentes.find(d => d.id === formacion.docenteId);
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${formacion.id}</td>
                <td>${formacion.codigo}</td>
                <td>${formacion.nombre}</td>
                <td>${formacion.duracion} horas</td>
                <td>${formacion.modalidad}</td>
                <td>${docente ? `${docente.nombres} ${docente.apellidos}` : 'No asignado'}</td>
                <td><span class="badge badge-success">Inscrito</span></td>
                <td>
                    <button class="btn btn-sm btn-danger" onclick="darseDeBaja(${participanteId})">
                        <i class="fas fa-sign-out-alt"></i> Darse de baja
                    </button>
                </td>
            `;
            tbody.appendChild(tr);
        }

        function cargarFormacionesDisponibles(participante) {
            const tbody = document.querySelector('#tabla-formaciones-disponibles tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const formaciones = datosSistema.formaciones.filter(f => f.vacantes > 0);
            formaciones.forEach(formacion => {
                const docente = datosSistema.docentes.find(d => d.id === formacion.docenteId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formacion.id}</td>
                    <td>${formacion.codigo}</td>
                    <td>${formacion.nombre}</td>
                    <td>${formacion.duracion} horas</td>
                    <td>${formacion.modalidad}</td>
                    <td>${docente ? `${docente.nombres} ${docente.apellidos}` : 'No asignado'}</td>
                    <td>${formacion.vacantes}</td>
                    <td>
                        <button class="btn btn-sm btn-success" onclick="inscribirseEnFormacion(${formacion.id}, ${participante.id})">
                            <i class="fas fa-pen-alt"></i> Inscribirse
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ===== CRUD COMPLETO =====
        // PLANTELES
        function guardarPlantel() {
            const plantel = {
                id: datosSistema.planteles.length > 0 ? Math.max(...datosSistema.planteles.map(p => p.id)) + 1 : 1,
                codigoDependencia: document.getElementById('plantel-codigo-dependencia').value,
                codigoPlantel: document.getElementById('plantel-codigo-plantel').value,
                nombre: document.getElementById('plantel-nombre').value,
                direccion: document.getElementById('plantel-direccion').value,
                ciudad: document.getElementById('plantel-ciudad').value,
                telefono: document.getElementById('plantel-telefono').value,
                email: document.getElementById('plantel-email').value,
                directorId: document.getElementById('plantel-director').value ? parseInt(document.getElementById('plantel-director').value) : null,
                estado: 'activo'
            };

            datosSistema.planteles.push(plantel);
            guardarDatos();
            closeModal('modal-plantel');
            cargarPlanteles();
            actualizarEstadisticas();
            showAlert('Plantel guardado exitosamente', 'success');
        }

        function editarPlantel(id) {
            const plantel = datosSistema.planteles.find(p => p.id === id);
            if (!plantel) return;

            editandoId = id;
            document.getElementById('editar-plantel-id').value = plantel.id;
            document.getElementById('editar-plantel-codigo-dependencia').value = plantel.codigoDependencia;
            document.getElementById('editar-plantel-codigo-plantel').value = plantel.codigoPlantel;
            document.getElementById('editar-plantel-nombre').value = plantel.nombre;
            document.getElementById('editar-plantel-direccion').value = plantel.direccion;
            document.getElementById('editar-plantel-ciudad').value = plantel.ciudad;
            document.getElementById('editar-plantel-telefono').value = plantel.telefono || '';
            document.getElementById('editar-plantel-email').value = plantel.email || '';

            // Llenar select de directores
            const select = document.getElementById('editar-plantel-director');
            select.innerHTML = '<option value="">Seleccionar Director</option>';
            datosSistema.directores.forEach(director => {
                const option = document.createElement('option');
                option.value = director.id;
                option.textContent = `${director.nombres} ${director.apellidos}`;
                if (director.id === plantel.directorId) {
                    option.selected = true;
                }
                select.appendChild(option);
            });

            openModal('modal-editar-plantel');
        }

        function actualizarPlantel() {
            const id = editandoId;
            const index = datosSistema.planteles.findIndex(p => p.id === id);
            if (index === -1) return;

            datosSistema.planteles[index] = {
                ...datosSistema.planteles[index],
                codigoDependencia: document.getElementById('editar-plantel-codigo-dependencia').value,
                codigoPlantel: document.getElementById('editar-plantel-codigo-plantel').value,
                nombre: document.getElementById('editar-plantel-nombre').value,
                direccion: document.getElementById('editar-plantel-direccion').value,
                ciudad: document.getElementById('editar-plantel-ciudad').value,
                telefono: document.getElementById('editar-plantel-telefono').value,
                email: document.getElementById('editar-plantel-email').value,
                directorId: document.getElementById('editar-plantel-director').value ? parseInt(document.getElementById('editar-plantel-director').value) : null
            };

            guardarDatos();
            closeModal('modal-editar-plantel');
            cargarPlanteles();
            showAlert('Plantel actualizado exitosamente', 'success');
        }

        function eliminarPlantel(id) {
            if (!confirm('¿Está seguro de eliminar este plantel?')) return;
            
            datosSistema.planteles = datosSistema.planteles.filter(p => p.id !== id);
            guardarDatos();
            cargarPlanteles();
            actualizarEstadisticas();
            showAlert('Plantel eliminado exitosamente', 'success');
        }

        // DIRECTORES
        function guardarDirector() {
            const director = {
                id: datosSistema.directores.length > 0 ? Math.max(...datosSistema.directores.map(d => d.id)) + 1 : 1,
                cedula: document.getElementById('director-cedula').value,
                nombres: document.getElementById('director-nombres').value,
                apellidos: document.getElementById('director-apellidos').value,
                telefono: document.getElementById('director-telefono').value,
                email: document.getElementById('director-email').value,
                plantelId: parseInt(document.getElementById('director-plantel').value),
                estado: 'activo'
            };

            datosSistema.directores.push(director);
            guardarDatos();
            closeModal('modal-director');
            cargarDirectores();
            actualizarEstadisticas();
            showAlert('Director guardado exitosamente', 'success');
        }

        function editarDirector(id) {
            const director = datosSistema.directores.find(d => d.id === id);
            if (!director) return;

            editandoId = id;
            document.getElementById('editar-director-id').value = director.id;
            document.getElementById('editar-director-cedula').value = director.cedula;
            document.getElementById('editar-director-nombres').value = director.nombres;
            document.getElementById('editar-director-apellidos').value = director.apellidos;
            document.getElementById('editar-director-telefono').value = director.telefono;
            document.getElementById('editar-director-email').value = director.email;

            // Llenar select de planteles
            const select = document.getElementById('editar-director-plantel');
            select.innerHTML = '<option value="">Seleccione un plantel</option>';
            datosSistema.planteles.forEach(plantel => {
                const option = document.createElement('option');
                option.value = plantel.id;
                option.textContent = plantel.nombre;
                if (plantel.id === director.plantelId) {
                    option.selected = true;
                }
                select.appendChild(option);
            });

            openModal('modal-editar-director');
        }

        function actualizarDirector() {
            const id = editandoId;
            const index = datosSistema.directores.findIndex(d => d.id === id);
            if (index === -1) return;

            datosSistema.directores[index] = {
                ...datosSistema.directores[index],
                cedula: document.getElementById('editar-director-cedula').value,
                nombres: document.getElementById('editar-director-nombres').value,
                apellidos: document.getElementById('editar-director-apellidos').value,
                telefono: document.getElementById('editar-director-telefono').value,
                email: document.getElementById('editar-director-email').value,
                plantelId: parseInt(document.getElementById('editar-director-plantel').value)
            };

            guardarDatos();
            closeModal('modal-editar-director');
            cargarDirectores();
            showAlert('Director actualizado exitosamente', 'success');
        }

        function eliminarDirector(id) {
            if (!confirm('¿Está seguro de eliminar este director?')) return;
            
            datosSistema.directores = datosSistema.directores.filter(d => d.id !== id);
            guardarDatos();
            cargarDirectores();
            actualizarEstadisticas();
            showAlert('Director eliminado exitosamente', 'success');
        }

        // DOCENTES
        function guardarDocente() {
            const docente = {
                id: datosSistema.docentes.length > 0 ? Math.max(...datosSistema.docentes.map(d => d.id)) + 1 : 1,
                cedula: document.getElementById('docente-cedula').value,
                nombres: document.getElementById('docente-nombres').value,
                apellidos: document.getElementById('docente-apellidos').value,
                especialidad: document.getElementById('docente-especialidad').value,
                telefono: document.getElementById('docente-telefono').value,
                email: document.getElementById('docente-email').value,
                plantelId: parseInt(document.getElementById('docente-plantel').value),
                estado: 'activo'
            };

            datosSistema.docentes.push(docente);
            guardarDatos();
            closeModal('modal-docente');
            cargarDocentes();
            actualizarEstadisticas();
            showAlert('Docente guardado exitosamente', 'success');
        }

        function editarDocente(id) {
            const docente = datosSistema.docentes.find(d => d.id === id);
            if (!docente) return;

            editandoId = id;
            document.getElementById('editar-docente-id').value = docente.id;
            document.getElementById('editar-docente-cedula').value = docente.cedula;
            document.getElementById('editar-docente-nombres').value = docente.nombres;
            document.getElementById('editar-docente-apellidos').value = docente.apellidos;
            document.getElementById('editar-docente-especialidad').value = docente.especialidad;
            document.getElementById('editar-docente-telefono').value = docente.telefono;
            document.getElementById('editar-docente-email').value = docente.email;

            // Llenar select de planteles
            const select = document.getElementById('editar-docente-plantel');
            select.innerHTML = '<option value="">Seleccione un plantel</option>';
            datosSistema.planteles.forEach(plantel => {
                const option = document.createElement('option');
                option.value = plantel.id;
                option.textContent = plantel.nombre;
                if (plantel.id === docente.plantelId) {
                    option.selected = true;
                }
                select.appendChild(option);
            });

            openModal('modal-editar-docente');
        }

        function actualizarDocente() {
            const id = editandoId;
            const index = datosSistema.docentes.findIndex(d => d.id === id);
            if (index === -1) return;

            datosSistema.docentes[index] = {
                ...datosSistema.docentes[index],
                cedula: document.getElementById('editar-docente-cedula').value,
                nombres: document.getElementById('editar-docente-nombres').value,
                apellidos: document.getElementById('editar-docente-apellidos').value,
                especialidad: document.getElementById('editar-docente-especialidad').value,
                telefono: document.getElementById('editar-docente-telefono').value,
                email: document.getElementById('editar-docente-email').value,
                plantelId: parseInt(document.getElementById('editar-docente-plantel').value)
            };

            guardarDatos();
            closeModal('modal-editar-docente');
            cargarDocentes();
            showAlert('Docente actualizado exitosamente', 'success');
        }

        function eliminarDocente(id) {
            if (!confirm('¿Está seguro de eliminar este docente?')) return;
            
            datosSistema.docentes = datosSistema.docentes.filter(d => d.id !== id);
            guardarDatos();
            cargarDocentes();
            actualizarEstadisticas();
            showAlert('Docente eliminado exitosamente', 'success');
        }

        // PARTICIPANTES
        function toggleDiscapacidad() {
            const discapacidad = document.getElementById('participante-discapacidad').value;
            const detalleDiv = document.getElementById('discapacidad-detalle');
            detalleDiv.style.display = discapacidad === 'si' ? 'block' : 'none';
        }

        function toggleDiscapacidadEditar() {
            const discapacidad = document.getElementById('editar-participante-discapacidad').value;
            const detalleDiv = document.getElementById('editar-discapacidad-detalle');
            detalleDiv.style.display = discapacidad === 'si' ? 'block' : 'none';
        }

        function guardarParticipante() {
            const participante = {
                id: datosSistema.participantes.length > 0 ? Math.max(...datosSistema.participantes.map(p => p.id)) + 1 : 1,
                cedula: document.getElementById('participante-cedula').value,
                nombres: document.getElementById('participante-nombres').value,
                apellidos: document.getElementById('participante-apellidos').value,
                telefono: document.getElementById('participante-telefono').value,
                email: document.getElementById('participante-email').value,
                edad: parseInt(document.getElementById('participante-edad').value),
                sexo: document.getElementById('participante-sexo').value,
                fechaNacimiento: document.getElementById('participante-fecha-nacimiento').value,
                lugarNacimiento: document.getElementById('participante-lugar-nacimiento').value,
                parroquia: document.getElementById('participante-parroquia').value,
                direccion: document.getElementById('participante-direccion').value,
                discapacidad: document.getElementById('participante-discapacidad').value,
                discapacidadDetalle: document.getElementById('participante-discapacidad-detalle').value || '',
                tallaCamisa: document.getElementById('participante-talla-camisa').value,
                peso: document.getElementById('participante-peso').value,
                tallaPantalon: document.getElementById('participante-talla-pantalon').value,
                tallaZapato: document.getElementById('participante-talla-zapato').value,
                ocupacion: document.getElementById('participante-ocupacion').value,
                gradoInstruccion: document.getElementById('participante-grado-instruccion').value,
                formacionId: parseInt(document.getElementById('participante-formacion').value),
                docenteId: parseInt(document.getElementById('participante-docente').value),
                plantelId: parseInt(document.getElementById('participante-plantel').value),
                estado: 'activo'
            };

            datosSistema.participantes.push(participante);
            guardarDatos();
            closeModal('modal-participante');
            cargarParticipantes();
            actualizarEstadisticas();
            showAlert('Participante guardado exitosamente', 'success');
        }

        function editarParticipante(id) {
            const participante = datosSistema.participantes.find(p => p.id === id);
            if (!participante) return;

            editandoId = id;
            document.getElementById('editar-participante-id').value = participante.id;
            document.getElementById('editar-participante-cedula').value = participante.cedula;
            document.getElementById('editar-participante-nombres').value = participante.nombres;
            document.getElementById('editar-participante-apellidos').value = participante.apellidos;
            document.getElementById('editar-participante-telefono').value = participante.telefono;
            document.getElementById('editar-participante-email').value = participante.email;
            document.getElementById('editar-participante-edad').value = participante.edad;
            document.getElementById('editar-participante-sexo').value = participante.sexo;
            document.getElementById('editar-participante-fecha-nacimiento').value = participante.fechaNacimiento;
            document.getElementById('editar-participante-lugar-nacimiento').value = participante.lugarNacimiento;
            document.getElementById('editar-participante-parroquia').value = participante.parroquia;
            document.getElementById('editar-participante-direccion').value = participante.direccion;
            document.getElementById('editar-participante-discapacidad').value = participante.discapacidad;
            document.getElementById('editar-participante-discapacidad-detalle').value = participante.discapacidadDetalle || '';
            document.getElementById('editar-participante-talla-camisa').value = participante.tallaCamisa || '';
            document.getElementById('editar-participante-peso').value = participante.peso || '';
            document.getElementById('editar-participante-talla-pantalon').value = participante.tallaPantalon || '';
            document.getElementById('editar-participante-talla-zapato').value = participante.tallaZapato || '';
            document.getElementById('editar-participante-ocupacion').value = participante.ocupacion || '';
            document.getElementById('editar-participante-grado-instruccion').value = participante.gradoInstruccion;

            // Mostrar detalle de discapacidad si es necesario
            toggleDiscapacidadEditar();

            // Llenar selects
            llenarSelectsParaEditar(participante);

            openModal('modal-editar-participante');
        }

        function llenarSelectsParaEditar(participante) {
            // Formaciones
            const selectFormacion = document.getElementById('editar-participante-formacion');
            selectFormacion.innerHTML = '<option value="">Seleccionar Formación</option>';
            datosSistema.formaciones.forEach(formacion => {
                const option = document.createElement('option');
                option.value = formacion.id;
                option.textContent = formacion.nombre;
                if (formacion.id === participante.formacionId) {
                    option.selected = true;
                }
                selectFormacion.appendChild(option);
            });

            // Docentes
            const selectDocente = document.getElementById('editar-participante-docente');
            selectDocente.innerHTML = '<option value="">Seleccionar Docente</option>';
            datosSistema.docentes.forEach(docente => {
                const option = document.createElement('option');
                option.value = docente.id;
                option.textContent = `${docente.nombres} ${docente.apellidos}`;
                if (docente.id === participante.docenteId) {
                    option.selected = true;
                }
                selectDocente.appendChild(option);
            });

            // Planteles
            const selectPlantel = document.getElementById('editar-participante-plantel');
            selectPlantel.innerHTML = '<option value="">Seleccionar Plantel</option>';
            datosSistema.planteles.forEach(plantel => {
                const option = document.createElement('option');
                option.value = plantel.id;
                option.textContent = plantel.nombre;
                if (plantel.id === participante.plantelId) {
                    option.selected = true;
                }
                selectPlantel.appendChild(option);
            });
        }

        function actualizarParticipante() {
            const id = editandoId;
            const index = datosSistema.participantes.findIndex(p => p.id === id);
            if (index === -1) return;

            datosSistema.participantes[index] = {
                ...datosSistema.participantes[index],
                cedula: document.getElementById('editar-participante-cedula').value,
                nombres: document.getElementById('editar-participante-nombres').value,
                apellidos: document.getElementById('editar-participante-apellidos').value,
                telefono: document.getElementById('editar-participante-telefono').value,
                email: document.getElementById('editar-participante-email').value,
                edad: parseInt(document.getElementById('editar-participante-edad').value),
                sexo: document.getElementById('editar-participante-sexo').value,
                fechaNacimiento: document.getElementById('editar-participante-fecha-nacimiento').value,
                lugarNacimiento: document.getElementById('editar-participante-lugar-nacimiento').value,
                parroquia: document.getElementById('editar-participante-parroquia').value,
                direccion: document.getElementById('editar-participante-direccion').value,
                discapacidad: document.getElementById('editar-participante-discapacidad').value,
                discapacidadDetalle: document.getElementById('editar-participante-discapacidad-detalle').value || '',
                tallaCamisa: document.getElementById('editar-participante-talla-camisa').value,
                peso: document.getElementById('editar-participante-peso').value,
                tallaPantalon: document.getElementById('editar-participante-talla-pantalon').value,
                tallaZapato: document.getElementById('editar-participante-talla-zapato').value,
                ocupacion: document.getElementById('editar-participante-ocupacion').value,
                gradoInstruccion: document.getElementById('editar-participante-grado-instruccion').value,
                formacionId: parseInt(document.getElementById('editar-participante-formacion').value),
                docenteId: parseInt(document.getElementById('editar-participante-docente').value),
                plantelId: parseInt(document.getElementById('editar-participante-plantel').value)
            };

            guardarDatos();
            closeModal('modal-editar-participante');
            cargarParticipantes();
            showAlert('Participante actualizado exitosamente', 'success');
        }

        function eliminarParticipante(id) {
            if (!confirm('¿Está seguro de eliminar este participante?')) return;
            
            datosSistema.participantes = datosSistema.participantes.filter(p => p.id !== id);
            guardarDatos();
            cargarParticipantes();
            actualizarEstadisticas();
            showAlert('Participante eliminado exitosamente', 'success');
        }

        // FORMACIONES
        function guardarFormacion() {
            const formacion = {
                id: datosSistema.formaciones.length > 0 ? Math.max(...datosSistema.formaciones.map(f => f.id)) + 1 : 1,
                codigo: document.getElementById('formacion-codigo').value,
                nombre: document.getElementById('formacion-nombre').value,
                descripcion: document.getElementById('formacion-descripcion').value,
                duracion: parseInt(document.getElementById('formacion-duracion').value),
                modalidad: document.getElementById('formacion-modalidad').value,
                docenteId: parseInt(document.getElementById('formacion-docente').value),
                plantelId: parseInt(document.getElementById('formacion-plantel').value),
                fechaInicio: document.getElementById('formacion-fecha-inicio').value,
                fechaFin: document.getElementById('formacion-fecha-fin').value,
                vacantes: parseInt(document.getElementById('formacion-vacantes').value),
                estado: 'activa'
            };

            datosSistema.formaciones.push(formacion);
            guardarDatos();
            closeModal('modal-formacion');
            cargarFormaciones();
            actualizarEstadisticas();
            showAlert('Formación guardada exitosamente', 'success');
        }

        function editarFormacion(id) {
            const formacion = datosSistema.formaciones.find(f => f.id === id);
            if (!formacion) return;

            editandoId = id;
            document.getElementById('editar-formacion-id').value = formacion.id;
            document.getElementById('editar-formacion-codigo').value = formacion.codigo;
            document.getElementById('editar-formacion-nombre').value = formacion.nombre;
            document.getElementById('editar-formacion-descripcion').value = formacion.descripcion || '';
            document.getElementById('editar-formacion-duracion').value = formacion.duracion;
            document.getElementById('editar-formacion-modalidad').value = formacion.modalidad;
            document.getElementById('editar-formacion-fecha-inicio').value = formacion.fechaInicio;
            document.getElementById('editar-formacion-fecha-fin').value = formacion.fechaFin;
            document.getElementById('editar-formacion-vacantes').value = formacion.vacantes;

            // Llenar selects
            llenarSelectsParaEditarFormacion(formacion);

            openModal('modal-editar-formacion');
        }

        function llenarSelectsParaEditarFormacion(formacion) {
            // Docentes
            const selectDocente = document.getElementById('editar-formacion-docente');
            selectDocente.innerHTML = '<option value="">Seleccionar Docente</option>';
            datosSistema.docentes.forEach(docente => {
                const option = document.createElement('option');
                option.value = docente.id;
                option.textContent = `${docente.nombres} ${docente.apellidos}`;
                if (docente.id === formacion.docenteId) {
                    option.selected = true;
                }
                selectDocente.appendChild(option);
            });

            // Planteles
            const selectPlantel = document.getElementById('editar-formacion-plantel');
            selectPlantel.innerHTML = '<option value="">Seleccionar Plantel</option>';
            datosSistema.planteles.forEach(plantel => {
                const option = document.createElement('option');
                option.value = plantel.id;
                option.textContent = plantel.nombre;
                if (plantel.id === formacion.plantelId) {
                    option.selected = true;
                }
                selectPlantel.appendChild(option);
            });
        }

        function actualizarFormacion() {
            const id = editandoId;
            const index = datosSistema.formaciones.findIndex(f => f.id === id);
            if (index === -1) return;

            datosSistema.formaciones[index] = {
                ...datosSistema.formaciones[index],
                codigo: document.getElementById('editar-formacion-codigo').value,
                nombre: document.getElementById('editar-formacion-nombre').value,
                descripcion: document.getElementById('editar-formacion-descripcion').value,
                duracion: parseInt(document.getElementById('editar-formacion-duracion').value),
                modalidad: document.getElementById('editar-formacion-modalidad').value,
                docenteId: parseInt(document.getElementById('editar-formacion-docente').value),
                plantelId: parseInt(document.getElementById('editar-formacion-plantel').value),
                fechaInicio: document.getElementById('editar-formacion-fecha-inicio').value,
                fechaFin: document.getElementById('editar-formacion-fecha-fin').value,
                vacantes: parseInt(document.getElementById('editar-formacion-vacantes').value)
            };

            guardarDatos();
            closeModal('modal-editar-formacion');
            cargarFormaciones();
            showAlert('Formación actualizada exitosamente', 'success');
        }

        function eliminarFormacion(id) {
            if (!confirm('¿Está seguro de eliminar esta formación?')) return;
            
            datosSistema.formaciones = datosSistema.formaciones.filter(f => f.id !== id);
            guardarDatos();
            cargarFormaciones();
            actualizarEstadisticas();
            showAlert('Formación eliminada exitosamente', 'success');
        }

        // USUARIOS
        function cambiarTipoUsuario() {
            const rol = document.getElementById('usuario-rol').value;
            const container = document.getElementById('usuario-entidad-container');
            const select = document.getElementById('usuario-entidad');
            
            if (rol === 'admin') {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';
            document.getElementById('usuario-entidad-label').textContent = 
                rol === 'plantel' ? 'Plantel' : 
                rol === 'director' ? 'Director' :
                rol === 'docente' ? 'Docente' : 'Participante';

            // Llenar select según el rol
            select.innerHTML = '<option value="">Seleccionar</option>';
            
            switch(rol) {
                case 'plantel':
                    datosSistema.planteles.forEach(plantel => {
                        const option = document.createElement('option');
                        option.value = plantel.id;
                        option.textContent = plantel.nombre;
                        select.appendChild(option);
                    });
                    break;
                case 'director':
                    datosSistema.directores.forEach(director => {
                        const option = document.createElement('option');
                        option.value = director.id;
                        option.textContent = `${director.nombres} ${director.apellidos}`;
                        select.appendChild(option);
                    });
                    break;
                case 'docente':
                    datosSistema.docentes.forEach(docente => {
                        const option = document.createElement('option');
                        option.value = docente.id;
                        option.textContent = `${docente.nombres} ${docente.apellidos}`;
                        select.appendChild(option);
                    });
                    break;
                case 'participante':
                    datosSistema.participantes.forEach(participante => {
                        const option = document.createElement('option');
                        option.value = participante.id;
                        option.textContent = `${participante.nombres} ${participante.apellidos}`;
                        select.appendChild(option);
                    });
                    break;
            }
        }

        function cambiarTipoUsuarioEditar() {
            const rol = document.getElementById('editar-usuario-rol').value;
            const container = document.getElementById('editar-usuario-entidad-container');
            const select = document.getElementById('editar-usuario-entidad');
            
            if (rol === 'admin') {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';
            document.getElementById('editar-usuario-entidad-label').textContent = 
                rol === 'plantel' ? 'Plantel' : 
                rol === 'director' ? 'Director' :
                rol === 'docente' ? 'Docente' : 'Participante';

            // Llenar select según el rol
            select.innerHTML = '<option value="">Seleccionar</option>';
            
            switch(rol) {
                case 'plantel':
                    datosSistema.planteles.forEach(plantel => {
                        const option = document.createElement('option');
                        option.value = plantel.id;
                        option.textContent = plantel.nombre;
                        select.appendChild(option);
                    });
                    break;
                case 'director':
                    datosSistema.directores.forEach(director => {
                        const option = document.createElement('option');
                        option.value = director.id;
                        option.textContent = `${director.nombres} ${director.apellidos}`;
                        select.appendChild(option);
                    });
                    break;
                case 'docente':
                    datosSistema.docentes.forEach(docente => {
                        const option = document.createElement('option');
                        option.value = docente.id;
                        option.textContent = `${docente.nombres} ${docente.apellidos}`;
                        select.appendChild(option);
                    });
                    break;
                case 'participante':
                    datosSistema.participantes.forEach(participante => {
                        const option = document.createElement('option');
                        option.value = participante.id;
                        option.textContent = `${participante.nombres} ${participante.apellidos}`;
                        select.appendChild(option);
                    });
                    break;
            }
        }

        function guardarUsuario() {
            const password = document.getElementById('usuario-password').value;
            const confirmPassword = document.getElementById('usuario-confirm-password').value;

            if (password !== confirmPassword) {
                showAlert('Las contraseñas no coinciden', 'error');
                return;
            }

            const usuario = {
                id: datosSistema.usuarios.length > 0 ? Math.max(...datosSistema.usuarios.map(u => u.id)) + 1 : 2,
                username: document.getElementById('usuario-username').value,
                password: password,
                email: document.getElementById('usuario-email').value,
                nombre: '', // Se completará según el rol
                rol: document.getElementById('usuario-rol').value,
                entidadId: document.getElementById('usuario-entidad').value ? parseInt(document.getElementById('usuario-entidad').value) : null,
                estado: 'activo',
                ultimoAcceso: null
            };

            // Obtener nombre según la entidad
            switch(usuario.rol) {
                case 'plantel':
                    const plantel = datosSistema.planteles.find(p => p.id === usuario.entidadId);
                    usuario.nombre = plantel ? plantel.nombre : 'Plantel';
                    break;
                case 'director':
                    const director = datosSistema.directores.find(d => d.id === usuario.entidadId);
                    usuario.nombre = director ? `${director.nombres} ${director.apellidos}` : 'Director';
                    break;
                case 'docente':
                    const docente = datosSistema.docentes.find(d => d.id === usuario.entidadId);
                    usuario.nombre = docente ? `${docente.nombres} ${docente.apellidos}` : 'Docente';
                    break;
                case 'participante':
                    const participante = datosSistema.participantes.find(p => p.id === usuario.entidadId);
                    usuario.nombre = participante ? `${participante.nombres} ${participante.apellidos}` : 'Participante';
                    break;
                case 'admin':
                    usuario.nombre = 'Administrador';
                    break;
            }

            datosSistema.usuarios.push(usuario);
            guardarDatos();
            closeModal('modal-usuario');
            cargarUsuarios();
            showAlert('Usuario creado exitosamente', 'success');
        }

        function editarUsuario(id) {
            const usuario = datosSistema.usuarios.find(u => u.id === id);
            if (!usuario) return;

            editandoId = id;
            document.getElementById('editar-usuario-id').value = usuario.id;
            document.getElementById('editar-usuario-username').value = usuario.username;
            document.getElementById('editar-usuario-email').value = usuario.email;
            document.getElementById('editar-usuario-rol').value = usuario.rol;
            document.getElementById('editar-usuario-estado').value = usuario.estado;

            // Configurar entidad según el rol
            cambiarTipoUsuarioEditar();
            
            if (usuario.entidadId && usuario.rol !== 'admin') {
                const select = document.getElementById('editar-usuario-entidad');
                setTimeout(() => {
                    select.value = usuario.entidadId;
                }, 100);
            }

            openModal('modal-editar-usuario');
        }

        function actualizarUsuario() {
            const id = editandoId;
            const index = datosSistema.usuarios.findIndex(u => u.id === id);
            if (index === -1) return;

            const nuevaPassword = document.getElementById('editar-usuario-password').value;
            const confirmPassword = document.getElementById('editar-usuario-confirm-password').value;

            if (nuevaPassword && nuevaPassword !== confirmPassword) {
                showAlert('Las contraseñas no coinciden', 'error');
                return;
            }

            const usuarioActualizado = {
                ...datosSistema.usuarios[index],
                username: document.getElementById('editar-usuario-username').value,
                email: document.getElementById('editar-usuario-email').value,
                rol: document.getElementById('editar-usuario-rol').value,
                estado: document.getElementById('editar-usuario-estado').value,
                entidadId: document.getElementById('editar-usuario-entidad') ? 
                    parseInt(document.getElementById('editar-usuario-entidad').value) : null
            };

            if (nuevaPassword) {
                usuarioActualizado.password = nuevaPassword;
            }

            // Actualizar nombre según la entidad
            switch(usuarioActualizado.rol) {
                case 'plantel':
                    const plantel = datosSistema.planteles.find(p => p.id === usuarioActualizado.entidadId);
                    usuarioActualizado.nombre = plantel ? plantel.nombre : 'Plantel';
                    break;
                case 'director':
                    const director = datosSistema.directores.find(d => d.id === usuarioActualizado.entidadId);
                    usuarioActualizado.nombre = director ? `${director.nombres} ${director.apellidos}` : 'Director';
                    break;
                case 'docente':
                    const docente = datosSistema.docentes.find(d => d.id === usuarioActualizado.entidadId);
                    usuarioActualizado.nombre = docente ? `${docente.nombres} ${docente.apellidos}` : 'Docente';
                    break;
                case 'participante':
                    const participante = datosSistema.participantes.find(p => p.id === usuarioActualizado.entidadId);
                    usuarioActualizado.nombre = participante ? `${participante.nombres} ${participante.apellidos}` : 'Participante';
                    break;
                case 'admin':
                    usuarioActualizado.nombre = 'Administrador';
                    break;
            }

            datosSistema.usuarios[index] = usuarioActualizado;
            guardarDatos();
            closeModal('modal-editar-usuario');
            cargarUsuarios();
            showAlert('Usuario actualizado exitosamente', 'success');
        }

        function eliminarUsuario(id) {
            if (id === 1) {
                showAlert('No se puede eliminar el usuario administrador principal', 'error');
                return;
            }
            
            if (!confirm('¿Está seguro de eliminar este usuario?')) return;
            
            datosSistema.usuarios = datosSistema.usuarios.filter(u => u.id !== id);
            guardarDatos();
            cargarUsuarios();
            showAlert('Usuario eliminado exitosamente', 'success');
        }

        // ===== FUNCIONES DE INTERFACES =====
        function accederInterfaz(tipo) {
            const usuarioActual = datosSistema.usuarios.find(u => 
                u.rol === tipo && u.estado === 'activo'
            );

            if (usuarioActual) {
                // Ocultar admin dashboard
                document.getElementById('admin-dashboard').classList.add('hidden');
                
                // Mostrar dashboard del usuario
                mostrarDashboard(tipo, usuarioActual);
                
                showAlert(`Accediendo como ${tipo}`, 'info');
            } else {
                showAlert(`No hay usuarios ${tipo} activos disponibles`, 'warning');
            }
        }

        function accederInterfazPlantel(plantelId) {
            const plantel = datosSistema.planteles.find(p => p.id === plantelId);
            if (!plantel) {
                showAlert('Plantel no encontrado', 'error');
                return;
            }

            const usuarioPlantel = datosSistema.usuarios.find(u => 
                u.rol === 'plantel' && u.entidadId === plantelId
            );

            if (!usuarioPlantel) {
                // Crear usuario temporal para el plantel
                usuarioPlantel = {
                    id: 999999,
                    username: `plantel_${plantel.id}`,
                    password: 'temp123',
                    nombre: plantel.nombre,
                    rol: 'plantel',
                    entidadId: plantelId,
                    email: plantel.email || '',
                    estado: 'activo',
                    ultimoAcceso: new Date().toISOString()
                };
            }

            // Ocultar admin dashboard
            document.getElementById('admin-dashboard').classList.add('hidden');
            
            // Mostrar dashboard del plantel
            mostrarDashboard('plantel', usuarioPlantel);
            
            showAlert(`Accediendo al plantel ${plantel.nombre}`, 'info');
        }

        function volverAlAdmin() {
            // Ocultar todos los dashboards
            document.querySelectorAll('.dashboard-container').forEach(dash => {
                dash.classList.add('hidden');
            });
            
            // Mostrar admin dashboard
            document.getElementById('admin-dashboard').classList.remove('hidden');
            
            // Restaurar sesión de admin
            currentUser = datosSistema.usuarios.find(u => u.id === 1);
            currentRole = 'admin';
            
            // Recargar datos del admin
            actualizarEstadisticas();
            cargarPlanteles();
            cargarDirectores();
            cargarDocentes();
            cargarParticipantes();
            cargarFormaciones();
            cargarUsuarios();
            
            showAlert('Volviendo al panel de administración', 'info');
        }

        // ===== FUNCIONES DE UTILIDAD =====
        function showAlert(message, type = 'info', duration = 5000) {
            const alertContainer = document.getElementById('alert-container');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            alertContainer.appendChild(alert);

            setTimeout(() => {
                alert.style.opacity = '0';
                setTimeout(() => alert.remove(), 300);
            }, duration);
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function openModalPlantel(modalId) {
            // Para plantel, solo mostrar modales de docente, formación y participante
            openModal('modal-docente');
        }

        function openModalDirector(modalId) {
            // Para director, solo mostrar modales de docente, formación y participante
            openModal('modal-docente');
        }

        function openModalDocente(modalId) {
            // Para docente, solo mostrar modal de participante
            openModal('modal-participante');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            // Limpiar formularios
            if (modalId.includes('modal-')) {
                const form = document.querySelector(`#${modalId} form`);
                if (form) form.reset();
            }
            editandoId = null;
        }

        function actualizarEstadisticas() {
            document.getElementById('stat-planteles').textContent = datosSistema.planteles.length;
            document.getElementById('stat-participantes').textContent = datosSistema.participantes.length;
            document.getElementById('stat-docentes').textContent = datosSistema.docentes.length;
            document.getElementById('stat-formaciones').textContent = datosSistema.formaciones.length;
        }

        function iniciarActualizacionAutomatica() {
            if (intervaloActualizacion) {
                clearInterval(intervaloActualizacion);
            }

            const intervalo = datosSistema.configuracion.intervaloActualizacion * 1000;
            intervaloActualizacion = setInterval(() => {
                actualizarInterfazActual();
            }, intervalo);
        }

        function actualizarInterfazActual() {
            if (currentRole === 'admin') {
                const activeSection = document.querySelector('.content-section:not(.hidden)');
                if (activeSection) {
                    const sectionId = activeSection.id.replace('section-', '');
                    cargarSeccionAdmin(sectionId);
                }
            } else if (currentRole === 'plantel') {
                const activeSection = document.querySelector('.content-section:not(.hidden)');
                if (activeSection) {
                    const sectionId = activeSection.id.replace('section-', '');
                    cargarSeccionPlantel(sectionId);
                }
            } else if (currentRole === 'director') {
                const activeSection = document.querySelector('.content-section:not(.hidden)');
                if (activeSection) {
                    const sectionId = activeSection.id.replace('section-', '');
                    cargarSeccionDirector(sectionId);
                }
            } else if (currentRole === 'docente') {
                const activeSection = document.querySelector('.content-section:not(.hidden)');
                if (activeSection) {
                    const sectionId = activeSection.id.replace('section-', '');
                    cargarSeccionDocente(sectionId);
                }
            } else if (currentRole === 'participante') {
                const activeSection = document.querySelector('.content-section:not(.hidden)');
                if (activeSection) {
                    const sectionId = activeSection.id.replace('section-', '');
                    cargarSeccionParticipante(sectionId);
                }
            }
            guardarDatos();
        }

        function logout() {
            // Limpiar usuario actual
            currentUser = null;
            currentRole = null;

            // Detener intervalo de actualización
            if (intervaloActualizacion) {
                clearInterval(intervaloActualizacion);
                intervaloActualizacion = null;
            }

            // Ocultar todos los dashboards
            document.querySelectorAll('.dashboard-container').forEach(dash => {
                dash.classList.add('hidden');
            });

            // Mostrar login
            document.getElementById('login-container').classList.remove('hidden');

            // Limpiar formulario de login
            document.getElementById('login-form').reset();

            showAlert('Sesión cerrada exitosamente', 'success');
        }

        function configurarModoConexion() {
            const statusElement = document.getElementById('connection-status');
            if (modoConexion === 'online') {
                statusElement.className = 'connection-status connection-online';
                statusElement.innerHTML = '<i class="fas fa-wifi"></i><span>Modo Online</span>';
                sincronizarDatos();
            } else {
                statusElement.className = 'connection-status connection-offline';
                statusElement.innerHTML = '<i class="fas fa-wifi-slash"></i><span>Modo Offline</span>';
            }
        }

        function sincronizarDatos() {
            if (modoConexion === 'offline') {
                showAlert('Modo offline activado. No se puede sincronizar.', 'warning');
                return;
            }

            showAlert('Sincronizando datos...', 'info');
            // Simular sincronización
            setTimeout(() => {
                guardarDatos();
                showAlert('Datos sincronizados correctamente', 'success');
            }, 1000);
        }

        function repararSistema() {
            if (confirm('¿Está seguro de reparar el sistema? Esto puede tomar unos momentos.')) {
                showAlert('Reparando sistema...', 'info');
                
                // Verificar y reparar datos
                datosSistema.planteles = datosSistema.planteles || [];
                datosSistema.directores = datosSistema.directores || [];
                datosSistema.docentes = datosSistema.docentes || [];
                datosSistema.participantes = datosSistema.participantes || [];
                datosSistema.formaciones = datosSistema.formaciones || [];
                datosSistema.usuarios = datosSistema.usuarios || [];
                datosSistema.configuracion = datosSistema.configuracion || {
                    intervaloActualizacion: 60,
                    frecuenciaBackup: 'daily',
                    modoConexion: 'online'
                };

                // Asegurar que exista el usuario admin
                if (!datosSistema.usuarios.find(u => u.id === 1)) {
                    datosSistema.usuarios.unshift({
                        id: 1,
                        username: 'pabloemiliorico24@gmail.com',
                        password: 'Perp.241',
                        email: 'pabloemiliorico24@gmail.com',
                        nombre: 'Administrador Principal',
                        rol: 'admin',
                        estado: 'activo',
                        ultimoAcceso: null
                    });
                }

                guardarDatos();
                showAlert('Sistema reparado exitosamente', 'success');
            }
        }

        function cargarVersionAnterior() {
            const versiones = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('complejoVirtualEPE_backup_')) {
                    versiones.push(key);
                }
            }

            if (versiones.length === 0) {
                showAlert('No hay versiones anteriores disponibles', 'warning');
                return;
            }

            const ultimaVersion = versiones.sort().pop();
            const confirmacion = confirm(`¿Cargar versión ${ultimaVersion}?`);
            
            if (confirmacion) {
                const datos = JSON.parse(localStorage.getItem(ultimaVersion));
                datosSistema = datos;
                guardarDatos();
                location.reload();
            }
        }

        function actualizarDesdeGitHub() {
            showAlert('Actualizando desde GitHub...', 'info');
            // Simular actualización
            setTimeout(() => {
                showAlert('Sistema actualizado correctamente desde GitHub', 'success');
            }, 2000);
        }

        function guardarConfiguracion() {
            datosSistema.configuracion.intervaloActualizacion = 
                parseInt(document.getElementById('intervalo-actualizacion').value) || 60;
            datosSistema.configuracion.frecuenciaBackup = 
                document.getElementById('frecuencia-backup').value || 'daily';
            
            guardarDatos();
            iniciarActualizacionAutomatica();
            showAlert('Configuración guardada exitosamente', 'success');
        }

        function guardarPerfilAdmin() {
            const usuario = datosSistema.usuarios.find(u => u.id === 1);
            if (!usuario) return;

            const currentPassword = document.getElementById('admin-current-password').value;
            const newPassword = document.getElementById('admin-new-password').value;
            const confirmPassword = document.getElementById('admin-confirm-password').value;

            if (currentPassword && usuario.password !== currentPassword) {
                showAlert('Contraseña actual incorrecta', 'error');
                return;
            }

            if (newPassword && newPassword !== confirmPassword) {
                showAlert('Las contraseñas nuevas no coinciden', 'error');
                return;
            }

            usuario.nombre = document.getElementById('admin-profile-name').value;
            usuario.email = document.getElementById('admin-profile-email').value;
            
            if (newPassword) {
                usuario.password = newPassword;
            }

            guardarDatos();
            showAlert('Perfil actualizado exitosamente', 'success');
        }

        function inscribirseEnFormacion(formacionId, participanteId) {
            const participanteIndex = datosSistema.participantes.findIndex(p => p.id === participanteId);
            if (participanteIndex === -1) return;

            const formacion = datosSistema.formaciones.find(f => f.id === formacionId);
            if (!formacion || formacion.vacantes <= 0) {
                showAlert('No hay vacantes disponibles en esta formación', 'error');
                return;
            }

            datosSistema.participantes[participanteIndex].formacionId = formacionId;
            datosSistema.participantes[participanteIndex].docenteId = formacion.docenteId;
            datosSistema.participantes[participanteIndex].plantelId = formacion.plantelId;

            // Reducir vacantes
            const formacionIndex = datosSistema.formaciones.findIndex(f => f.id === formacionId);
            datosSistema.formaciones[formacionIndex].vacantes -= 1;

            guardarDatos();
            showAlert('Inscripción realizada exitosamente', 'success');
            cargarSeccionParticipante('inscribirse-formacion');
            cargarSeccionParticipante('mis-formaciones');
        }

        function darseDeBaja(participanteId) {
            if (!confirm('¿Está seguro de darse de baja de esta formación?')) return;

            const participanteIndex = datosSistema.participantes.findIndex(p => p.id === participanteId);
            if (participanteIndex === -1) return;

            const formacionId = datosSistema.participantes[participanteIndex].formacionId;
            
            // Aumentar vacantes
            const formacionIndex = datosSistema.formaciones.findIndex(f => f.id === formacionId);
            if (formacionIndex !== -1) {
                datosSistema.formaciones[formacionIndex].vacantes += 1;
            }

            datosSistema.participantes[participanteIndex].formacionId = null;
            datosSistema.participantes[participanteIndex].docenteId = null;

            guardarDatos();
            showAlert('Se ha dado de baja exitosamente', 'success');
            cargarSeccionParticipante('mis-formaciones');
        }
    </script>
</body>
</html>